var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},buffer$1={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr=typeof Uint8Array!="undefined"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$1=0,len=code.length;i$1<len;++i$1)lookup[i$1]=code[i$1],revLookup[code.charCodeAt(i$1)]=i$1;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;function getLens(e){var r=e.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");t===-1&&(t=r);var n=t===r?0:4-t%4;return[t,n]}function byteLength(e){var r=getLens(e),t=r[0],n=r[1];return(t+n)*3/4-n}function _byteLength(e,r,t){return(r+t)*3/4-t}function toByteArray(e){var r,t=getLens(e),n=t[0],s=t[1],l=new Arr(_byteLength(e,n,s)),u=0,o=s>0?n-4:n,m;for(m=0;m<o;m+=4)r=revLookup[e.charCodeAt(m)]<<18|revLookup[e.charCodeAt(m+1)]<<12|revLookup[e.charCodeAt(m+2)]<<6|revLookup[e.charCodeAt(m+3)],l[u++]=r>>16&255,l[u++]=r>>8&255,l[u++]=r&255;return s===2&&(r=revLookup[e.charCodeAt(m)]<<2|revLookup[e.charCodeAt(m+1)]>>4,l[u++]=r&255),s===1&&(r=revLookup[e.charCodeAt(m)]<<10|revLookup[e.charCodeAt(m+1)]<<4|revLookup[e.charCodeAt(m+2)]>>2,l[u++]=r>>8&255,l[u++]=r&255),l}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[e&63]}function encodeChunk(e,r,t){for(var n,s=[],l=r;l<t;l+=3)n=(e[l]<<16&16711680)+(e[l+1]<<8&65280)+(e[l+2]&255),s.push(tripletToBase64(n));return s.join("")}function fromByteArray(e){for(var r,t=e.length,n=t%3,s=[],l=16383,u=0,o=t-n;u<o;u+=l)s.push(encodeChunk(e,u,u+l>o?o:u+l));return n===1?(r=e[t-1],s.push(lookup[r>>2]+lookup[r<<4&63]+"==")):n===2&&(r=(e[t-2]<<8)+e[t-1],s.push(lookup[r>>10]+lookup[r>>4&63]+lookup[r<<2&63]+"=")),s.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(e,r,t,n,s){var l,u,o=s*8-n-1,m=(1<<o)-1,_=m>>1,p=-7,A=t?s-1:0,v=t?-1:1,w=e[r+A];for(A+=v,l=w&(1<<-p)-1,w>>=-p,p+=o;p>0;l=l*256+e[r+A],A+=v,p-=8);for(u=l&(1<<-p)-1,l>>=-p,p+=n;p>0;u=u*256+e[r+A],A+=v,p-=8);if(l===0)l=1-_;else{if(l===m)return u?NaN:(w?-1:1)*(1/0);u=u+Math.pow(2,n),l=l-_}return(w?-1:1)*u*Math.pow(2,l-n)},ieee754.write=function(e,r,t,n,s,l){var u,o,m,_=l*8-s-1,p=(1<<_)-1,A=p>>1,v=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:l-1,T=n?1:-1,I=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(o=isNaN(r)?1:0,u=p):(u=Math.floor(Math.log(r)/Math.LN2),r*(m=Math.pow(2,-u))<1&&(u--,m*=2),u+A>=1?r+=v/m:r+=v*Math.pow(2,1-A),r*m>=2&&(u++,m/=2),u+A>=p?(o=0,u=p):u+A>=1?(o=(r*m-1)*Math.pow(2,s),u=u+A):(o=r*Math.pow(2,A-1)*Math.pow(2,s),u=0));s>=8;e[t+w]=o&255,w+=T,o/=256,s-=8);for(u=u<<s|o,_+=s;_>0;e[t+w]=u&255,w+=T,u/=256,_-=8);e[t+w-T]|=I*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const r=base64Js,t=ieee754,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=D,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s,o.TYPED_ARRAY_SUPPORT=l(),!o.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const d=new Uint8Array(1),a={foo:function(){return 42}};return Object.setPrototypeOf(a,Uint8Array.prototype),Object.setPrototypeOf(d,a),d.foo()===42}catch(d){return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.byteOffset}});function u(d){if(d>s)throw new RangeError('The value "'+d+'" is invalid for option "size"');const a=new Uint8Array(d);return Object.setPrototypeOf(a,o.prototype),a}function o(d,a,f){if(typeof d=="number"){if(typeof a=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return A(d)}return m(d,a,f)}o.poolSize=8192;function m(d,a,f){if(typeof d=="string")return v(d,a);if(ArrayBuffer.isView(d))return T(d);if(d==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(ae(d,ArrayBuffer)||d&&ae(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(ae(d,SharedArrayBuffer)||d&&ae(d.buffer,SharedArrayBuffer)))return I(d,a,f);if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const E=d.valueOf&&d.valueOf();if(E!=null&&E!==d)return o.from(E,a,f);const b=N(d);if(b)return b;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof d[Symbol.toPrimitive]=="function")return o.from(d[Symbol.toPrimitive]("string"),a,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}o.from=function(d,a,f){return m(d,a,f)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function _(d){if(typeof d!="number")throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function p(d,a,f){return _(d),d<=0?u(d):a!==void 0?typeof f=="string"?u(d).fill(a,f):u(d).fill(a):u(d)}o.alloc=function(d,a,f){return p(d,a,f)};function A(d){return _(d),u(d<0?0:k(d)|0)}o.allocUnsafe=function(d){return A(d)},o.allocUnsafeSlow=function(d){return A(d)};function v(d,a){if((typeof a!="string"||a==="")&&(a="utf8"),!o.isEncoding(a))throw new TypeError("Unknown encoding: "+a);const f=B(d,a)|0;let E=u(f);const b=E.write(d,a);return b!==f&&(E=E.slice(0,b)),E}function w(d){const a=d.length<0?0:k(d.length)|0,f=u(a);for(let E=0;E<a;E+=1)f[E]=d[E]&255;return f}function T(d){if(ae(d,Uint8Array)){const a=new Uint8Array(d);return I(a.buffer,a.byteOffset,a.byteLength)}return w(d)}function I(d,a,f){if(a<0||d.byteLength<a)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<a+(f||0))throw new RangeError('"length" is outside of buffer bounds');let E;return a===void 0&&f===void 0?E=new Uint8Array(d):f===void 0?E=new Uint8Array(d,a):E=new Uint8Array(d,a,f),Object.setPrototypeOf(E,o.prototype),E}function N(d){if(o.isBuffer(d)){const a=k(d.length)|0,f=u(a);return f.length===0||d.copy(f,0,0,a),f}if(d.length!==void 0)return typeof d.length!="number"||Te(d.length)?u(0):w(d);if(d.type==="Buffer"&&Array.isArray(d.data))return w(d.data)}function k(d){if(d>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return d|0}function D(d){return+d!=d&&(d=0),o.alloc(+d)}o.isBuffer=function(a){return a!=null&&a._isBuffer===!0&&a!==o.prototype},o.compare=function(a,f){if(ae(a,Uint8Array)&&(a=o.from(a,a.offset,a.byteLength)),ae(f,Uint8Array)&&(f=o.from(f,f.offset,f.byteLength)),!o.isBuffer(a)||!o.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===f)return 0;let E=a.length,b=f.length;for(let S=0,$=Math.min(E,b);S<$;++S)if(a[S]!==f[S]){E=a[S],b=f[S];break}return E<b?-1:b<E?1:0},o.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(a,f){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(a.length===0)return o.alloc(0);let E;if(f===void 0)for(f=0,E=0;E<a.length;++E)f+=a[E].length;const b=o.allocUnsafe(f);let S=0;for(E=0;E<a.length;++E){let $=a[E];if(ae($,Uint8Array))S+$.length>b.length?(o.isBuffer($)||($=o.from($)),$.copy(b,S)):Uint8Array.prototype.set.call(b,$,S);else if(o.isBuffer($))$.copy(b,S);else throw new TypeError('"list" argument must be an Array of Buffers');S+=$.length}return b};function B(d,a){if(o.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||ae(d,ArrayBuffer))return d.byteLength;if(typeof d!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);const f=d.length,E=arguments.length>2&&arguments[2]===!0;if(!E&&f===0)return 0;let b=!1;for(;;)switch(a){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return Q(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return ge(d).length;default:if(b)return E?-1:Q(d).length;a=(""+a).toLowerCase(),b=!0}}o.byteLength=B;function R(d,a,f){let E=!1;if((a===void 0||a<0)&&(a=0),a>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,a>>>=0,f<=a))return"";for(d||(d="utf8");;)switch(d){case"hex":return he(this,a,f);case"utf8":case"utf-8":return ie(this,a,f);case"ascii":return H(this,a,f);case"latin1":case"binary":return se(this,a,f);case"base64":return te(this,a,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _e(this,a,f);default:if(E)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),E=!0}}o.prototype._isBuffer=!0;function O(d,a,f){const E=d[a];d[a]=d[f],d[f]=E}o.prototype.swap16=function(){const a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<a;f+=2)O(this,f,f+1);return this},o.prototype.swap32=function(){const a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<a;f+=4)O(this,f,f+3),O(this,f+1,f+2);return this},o.prototype.swap64=function(){const a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<a;f+=8)O(this,f,f+7),O(this,f+1,f+6),O(this,f+2,f+5),O(this,f+3,f+4);return this},o.prototype.toString=function(){const a=this.length;return a===0?"":arguments.length===0?ie(this,0,a):R.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(a){if(!o.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:o.compare(this,a)===0},o.prototype.inspect=function(){let a="";const f=e.INSPECT_MAX_BYTES;return a=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(a+=" ... "),"<Buffer "+a+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(a,f,E,b,S){if(ae(a,Uint8Array)&&(a=o.from(a,a.offset,a.byteLength)),!o.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(f===void 0&&(f=0),E===void 0&&(E=a?a.length:0),b===void 0&&(b=0),S===void 0&&(S=this.length),f<0||E>a.length||b<0||S>this.length)throw new RangeError("out of range index");if(b>=S&&f>=E)return 0;if(b>=S)return-1;if(f>=E)return 1;if(f>>>=0,E>>>=0,b>>>=0,S>>>=0,this===a)return 0;let $=S-b,z=E-f;const V=Math.min($,z),Y=this.slice(b,S),J=a.slice(f,E);for(let W=0;W<V;++W)if(Y[W]!==J[W]){$=Y[W],z=J[W];break}return $<z?-1:z<$?1:0};function P(d,a,f,E,b){if(d.length===0)return-1;if(typeof f=="string"?(E=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,Te(f)&&(f=b?0:d.length-1),f<0&&(f=d.length+f),f>=d.length){if(b)return-1;f=d.length-1}else if(f<0)if(b)f=0;else return-1;if(typeof a=="string"&&(a=o.from(a,E)),o.isBuffer(a))return a.length===0?-1:L(d,a,f,E,b);if(typeof a=="number")return a=a&255,typeof Uint8Array.prototype.indexOf=="function"?b?Uint8Array.prototype.indexOf.call(d,a,f):Uint8Array.prototype.lastIndexOf.call(d,a,f):L(d,[a],f,E,b);throw new TypeError("val must be string, number or Buffer")}function L(d,a,f,E,b){let S=1,$=d.length,z=a.length;if(E!==void 0&&(E=String(E).toLowerCase(),E==="ucs2"||E==="ucs-2"||E==="utf16le"||E==="utf-16le")){if(d.length<2||a.length<2)return-1;S=2,$/=2,z/=2,f/=2}function V(J,W){return S===1?J[W]:J.readUInt16BE(W*S)}let Y;if(b){let J=-1;for(Y=f;Y<$;Y++)if(V(d,Y)===V(a,J===-1?0:Y-J)){if(J===-1&&(J=Y),Y-J+1===z)return J*S}else J!==-1&&(Y-=Y-J),J=-1}else for(f+z>$&&(f=$-z),Y=f;Y>=0;Y--){let J=!0;for(let W=0;W<z;W++)if(V(d,Y+W)!==V(a,W)){J=!1;break}if(J)return Y}return-1}o.prototype.includes=function(a,f,E){return this.indexOf(a,f,E)!==-1},o.prototype.indexOf=function(a,f,E){return P(this,a,f,E,!0)},o.prototype.lastIndexOf=function(a,f,E){return P(this,a,f,E,!1)};function M(d,a,f,E){f=Number(f)||0;const b=d.length-f;E?(E=Number(E),E>b&&(E=b)):E=b;const S=a.length;E>S/2&&(E=S/2);let $;for($=0;$<E;++$){const z=parseInt(a.substr($*2,2),16);if(Te(z))return $;d[f+$]=z}return $}function y(d,a,f,E){return ce(Q(a,d.length-f),d,f,E)}function U(d,a,f,E){return ce(le(a),d,f,E)}function F(d,a,f,E){return ce(ge(a),d,f,E)}function Z(d,a,f,E){return ce(we(a,d.length-f),d,f,E)}o.prototype.write=function(a,f,E,b){if(f===void 0)b="utf8",E=this.length,f=0;else if(E===void 0&&typeof f=="string")b=f,E=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(E)?(E=E>>>0,b===void 0&&(b="utf8")):(b=E,E=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const S=this.length-f;if((E===void 0||E>S)&&(E=S),a.length>0&&(E<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");b||(b="utf8");let $=!1;for(;;)switch(b){case"hex":return M(this,a,f,E);case"utf8":case"utf-8":return y(this,a,f,E);case"ascii":case"latin1":case"binary":return U(this,a,f,E);case"base64":return F(this,a,f,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,a,f,E);default:if($)throw new TypeError("Unknown encoding: "+b);b=(""+b).toLowerCase(),$=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function te(d,a,f){return a===0&&f===d.length?r.fromByteArray(d):r.fromByteArray(d.slice(a,f))}function ie(d,a,f){f=Math.min(d.length,f);const E=[];let b=a;for(;b<f;){const S=d[b];let $=null,z=S>239?4:S>223?3:S>191?2:1;if(b+z<=f){let V,Y,J,W;switch(z){case 1:S<128&&($=S);break;case 2:V=d[b+1],(V&192)===128&&(W=(S&31)<<6|V&63,W>127&&($=W));break;case 3:V=d[b+1],Y=d[b+2],(V&192)===128&&(Y&192)===128&&(W=(S&15)<<12|(V&63)<<6|Y&63,W>2047&&(W<55296||W>57343)&&($=W));break;case 4:V=d[b+1],Y=d[b+2],J=d[b+3],(V&192)===128&&(Y&192)===128&&(J&192)===128&&(W=(S&15)<<18|(V&63)<<12|(Y&63)<<6|J&63,W>65535&&W<1114112&&($=W))}}$===null?($=65533,z=1):$>65535&&($-=65536,E.push($>>>10&1023|55296),$=56320|$&1023),E.push($),b+=z}return fe(E)}const ne=4096;function fe(d){const a=d.length;if(a<=ne)return String.fromCharCode.apply(String,d);let f="",E=0;for(;E<a;)f+=String.fromCharCode.apply(String,d.slice(E,E+=ne));return f}function H(d,a,f){let E="";f=Math.min(d.length,f);for(let b=a;b<f;++b)E+=String.fromCharCode(d[b]&127);return E}function se(d,a,f){let E="";f=Math.min(d.length,f);for(let b=a;b<f;++b)E+=String.fromCharCode(d[b]);return E}function he(d,a,f){const E=d.length;(!a||a<0)&&(a=0),(!f||f<0||f>E)&&(f=E);let b="";for(let S=a;S<f;++S)b+=ye[d[S]];return b}function _e(d,a,f){const E=d.slice(a,f);let b="";for(let S=0;S<E.length-1;S+=2)b+=String.fromCharCode(E[S]+E[S+1]*256);return b}o.prototype.slice=function(a,f){const E=this.length;a=~~a,f=f===void 0?E:~~f,a<0?(a+=E,a<0&&(a=0)):a>E&&(a=E),f<0?(f+=E,f<0&&(f=0)):f>E&&(f=E),f<a&&(f=a);const b=this.subarray(a,f);return Object.setPrototypeOf(b,o.prototype),b};function G(d,a,f){if(d%1!==0||d<0)throw new RangeError("offset is not uint");if(d+a>f)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(a,f,E){a=a>>>0,f=f>>>0,E||G(a,f,this.length);let b=this[a],S=1,$=0;for(;++$<f&&(S*=256);)b+=this[a+$]*S;return b},o.prototype.readUintBE=o.prototype.readUIntBE=function(a,f,E){a=a>>>0,f=f>>>0,E||G(a,f,this.length);let b=this[a+--f],S=1;for(;f>0&&(S*=256);)b+=this[a+--f]*S;return b},o.prototype.readUint8=o.prototype.readUInt8=function(a,f){return a=a>>>0,f||G(a,1,this.length),this[a]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(a,f){return a=a>>>0,f||G(a,2,this.length),this[a]|this[a+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(a,f){return a=a>>>0,f||G(a,2,this.length),this[a]<<8|this[a+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(a,f){return a=a>>>0,f||G(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+this[a+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(a,f){return a=a>>>0,f||G(a,4,this.length),this[a]*16777216+(this[a+1]<<16|this[a+2]<<8|this[a+3])},o.prototype.readBigUInt64LE=de(function(a){a=a>>>0,X(a,"offset");const f=this[a],E=this[a+7];(f===void 0||E===void 0)&&ee(a,this.length-8);const b=f+this[++a]*2**8+this[++a]*2**16+this[++a]*2**24,S=this[++a]+this[++a]*2**8+this[++a]*2**16+E*2**24;return BigInt(b)+(BigInt(S)<<BigInt(32))}),o.prototype.readBigUInt64BE=de(function(a){a=a>>>0,X(a,"offset");const f=this[a],E=this[a+7];(f===void 0||E===void 0)&&ee(a,this.length-8);const b=f*2**24+this[++a]*2**16+this[++a]*2**8+this[++a],S=this[++a]*2**24+this[++a]*2**16+this[++a]*2**8+E;return(BigInt(b)<<BigInt(32))+BigInt(S)}),o.prototype.readIntLE=function(a,f,E){a=a>>>0,f=f>>>0,E||G(a,f,this.length);let b=this[a],S=1,$=0;for(;++$<f&&(S*=256);)b+=this[a+$]*S;return S*=128,b>=S&&(b-=Math.pow(2,8*f)),b},o.prototype.readIntBE=function(a,f,E){a=a>>>0,f=f>>>0,E||G(a,f,this.length);let b=f,S=1,$=this[a+--b];for(;b>0&&(S*=256);)$+=this[a+--b]*S;return S*=128,$>=S&&($-=Math.pow(2,8*f)),$},o.prototype.readInt8=function(a,f){return a=a>>>0,f||G(a,1,this.length),this[a]&128?(255-this[a]+1)*-1:this[a]},o.prototype.readInt16LE=function(a,f){a=a>>>0,f||G(a,2,this.length);const E=this[a]|this[a+1]<<8;return E&32768?E|4294901760:E},o.prototype.readInt16BE=function(a,f){a=a>>>0,f||G(a,2,this.length);const E=this[a+1]|this[a]<<8;return E&32768?E|4294901760:E},o.prototype.readInt32LE=function(a,f){return a=a>>>0,f||G(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},o.prototype.readInt32BE=function(a,f){return a=a>>>0,f||G(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},o.prototype.readBigInt64LE=de(function(a){a=a>>>0,X(a,"offset");const f=this[a],E=this[a+7];(f===void 0||E===void 0)&&ee(a,this.length-8);const b=this[a+4]+this[a+5]*2**8+this[a+6]*2**16+(E<<24);return(BigInt(b)<<BigInt(32))+BigInt(f+this[++a]*2**8+this[++a]*2**16+this[++a]*2**24)}),o.prototype.readBigInt64BE=de(function(a){a=a>>>0,X(a,"offset");const f=this[a],E=this[a+7];(f===void 0||E===void 0)&&ee(a,this.length-8);const b=(f<<24)+this[++a]*2**16+this[++a]*2**8+this[++a];return(BigInt(b)<<BigInt(32))+BigInt(this[++a]*2**24+this[++a]*2**16+this[++a]*2**8+E)}),o.prototype.readFloatLE=function(a,f){return a=a>>>0,f||G(a,4,this.length),t.read(this,a,!0,23,4)},o.prototype.readFloatBE=function(a,f){return a=a>>>0,f||G(a,4,this.length),t.read(this,a,!1,23,4)},o.prototype.readDoubleLE=function(a,f){return a=a>>>0,f||G(a,8,this.length),t.read(this,a,!0,52,8)},o.prototype.readDoubleBE=function(a,f){return a=a>>>0,f||G(a,8,this.length),t.read(this,a,!1,52,8)};function re(d,a,f,E,b,S){if(!o.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>b||a<S)throw new RangeError('"value" argument is out of bounds');if(f+E>d.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(a,f,E,b){if(a=+a,f=f>>>0,E=E>>>0,!b){const z=Math.pow(2,8*E)-1;re(this,a,f,E,z,0)}let S=1,$=0;for(this[f]=a&255;++$<E&&(S*=256);)this[f+$]=a/S&255;return f+E},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(a,f,E,b){if(a=+a,f=f>>>0,E=E>>>0,!b){const z=Math.pow(2,8*E)-1;re(this,a,f,E,z,0)}let S=E-1,$=1;for(this[f+S]=a&255;--S>=0&&($*=256);)this[f+S]=a/$&255;return f+E},o.prototype.writeUint8=o.prototype.writeUInt8=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,1,255,0),this[f]=a&255,f+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,2,65535,0),this[f]=a&255,this[f+1]=a>>>8,f+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,2,65535,0),this[f]=a>>>8,this[f+1]=a&255,f+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,4,4294967295,0),this[f+3]=a>>>24,this[f+2]=a>>>16,this[f+1]=a>>>8,this[f]=a&255,f+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,4,4294967295,0),this[f]=a>>>24,this[f+1]=a>>>16,this[f+2]=a>>>8,this[f+3]=a&255,f+4};function Ee(d,a,f,E,b){K(a,E,b,d,f,7);let S=Number(a&BigInt(4294967295));d[f++]=S,S=S>>8,d[f++]=S,S=S>>8,d[f++]=S,S=S>>8,d[f++]=S;let $=Number(a>>BigInt(32)&BigInt(4294967295));return d[f++]=$,$=$>>8,d[f++]=$,$=$>>8,d[f++]=$,$=$>>8,d[f++]=$,f}function pe(d,a,f,E,b){K(a,E,b,d,f,7);let S=Number(a&BigInt(4294967295));d[f+7]=S,S=S>>8,d[f+6]=S,S=S>>8,d[f+5]=S,S=S>>8,d[f+4]=S;let $=Number(a>>BigInt(32)&BigInt(4294967295));return d[f+3]=$,$=$>>8,d[f+2]=$,$=$>>8,d[f+1]=$,$=$>>8,d[f]=$,f+8}o.prototype.writeBigUInt64LE=de(function(a,f=0){return Ee(this,a,f,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=de(function(a,f=0){return pe(this,a,f,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(a,f,E,b){if(a=+a,f=f>>>0,!b){const V=Math.pow(2,8*E-1);re(this,a,f,E,V-1,-V)}let S=0,$=1,z=0;for(this[f]=a&255;++S<E&&($*=256);)a<0&&z===0&&this[f+S-1]!==0&&(z=1),this[f+S]=(a/$>>0)-z&255;return f+E},o.prototype.writeIntBE=function(a,f,E,b){if(a=+a,f=f>>>0,!b){const V=Math.pow(2,8*E-1);re(this,a,f,E,V-1,-V)}let S=E-1,$=1,z=0;for(this[f+S]=a&255;--S>=0&&($*=256);)a<0&&z===0&&this[f+S+1]!==0&&(z=1),this[f+S]=(a/$>>0)-z&255;return f+E},o.prototype.writeInt8=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,1,127,-128),a<0&&(a=255+a+1),this[f]=a&255,f+1},o.prototype.writeInt16LE=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,2,32767,-32768),this[f]=a&255,this[f+1]=a>>>8,f+2},o.prototype.writeInt16BE=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,2,32767,-32768),this[f]=a>>>8,this[f+1]=a&255,f+2},o.prototype.writeInt32LE=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,4,2147483647,-2147483648),this[f]=a&255,this[f+1]=a>>>8,this[f+2]=a>>>16,this[f+3]=a>>>24,f+4},o.prototype.writeInt32BE=function(a,f,E){return a=+a,f=f>>>0,E||re(this,a,f,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[f]=a>>>24,this[f+1]=a>>>16,this[f+2]=a>>>8,this[f+3]=a&255,f+4},o.prototype.writeBigInt64LE=de(function(a,f=0){return Ee(this,a,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=de(function(a,f=0){return pe(this,a,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function me(d,a,f,E,b,S){if(f+E>d.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function ve(d,a,f,E,b){return a=+a,f=f>>>0,b||me(d,a,f,4),t.write(d,a,f,E,23,4),f+4}o.prototype.writeFloatLE=function(a,f,E){return ve(this,a,f,!0,E)},o.prototype.writeFloatBE=function(a,f,E){return ve(this,a,f,!1,E)};function g(d,a,f,E,b){return a=+a,f=f>>>0,b||me(d,a,f,8),t.write(d,a,f,E,52,8),f+8}o.prototype.writeDoubleLE=function(a,f,E){return g(this,a,f,!0,E)},o.prototype.writeDoubleBE=function(a,f,E){return g(this,a,f,!1,E)},o.prototype.copy=function(a,f,E,b){if(!o.isBuffer(a))throw new TypeError("argument should be a Buffer");if(E||(E=0),!b&&b!==0&&(b=this.length),f>=a.length&&(f=a.length),f||(f=0),b>0&&b<E&&(b=E),b===E||a.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(E<0||E>=this.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("sourceEnd out of bounds");b>this.length&&(b=this.length),a.length-f<b-E&&(b=a.length-f+E);const S=b-E;return this===a&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,E,b):Uint8Array.prototype.set.call(a,this.subarray(E,b),f),S},o.prototype.fill=function(a,f,E,b){if(typeof a=="string"){if(typeof f=="string"?(b=f,f=0,E=this.length):typeof E=="string"&&(b=E,E=this.length),b!==void 0&&typeof b!="string")throw new TypeError("encoding must be a string");if(typeof b=="string"&&!o.isEncoding(b))throw new TypeError("Unknown encoding: "+b);if(a.length===1){const $=a.charCodeAt(0);(b==="utf8"&&$<128||b==="latin1")&&(a=$)}}else typeof a=="number"?a=a&255:typeof a=="boolean"&&(a=Number(a));if(f<0||this.length<f||this.length<E)throw new RangeError("Out of range index");if(E<=f)return this;f=f>>>0,E=E===void 0?this.length:E>>>0,a||(a=0);let S;if(typeof a=="number")for(S=f;S<E;++S)this[S]=a;else{const $=o.isBuffer(a)?a:o.from(a,b),z=$.length;if(z===0)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(S=0;S<E-f;++S)this[S+f]=$[S%z]}return this};const h={};function C(d,a,f){h[d]=class extends f{constructor(){super();Object.defineProperty(this,"message",{value:a.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${d}]`,this.stack,delete this.name}get code(){return d}set code(b){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:b,writable:!0})}toString(){return`${this.name} [${d}]: ${this.message}`}}}C("ERR_BUFFER_OUT_OF_BOUNDS",function(d){return d?`${d} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),C("ERR_INVALID_ARG_TYPE",function(d,a){return`The "${d}" argument must be of type number. Received type ${typeof a}`},TypeError),C("ERR_OUT_OF_RANGE",function(d,a,f){let E=`The value of "${d}" is out of range.`,b=f;return Number.isInteger(f)&&Math.abs(f)>2**32?b=x(String(f)):typeof f=="bigint"&&(b=String(f),(f>BigInt(2)**BigInt(32)||f<-(BigInt(2)**BigInt(32)))&&(b=x(b)),b+="n"),E+=` It must be ${a}. Received ${b}`,E},RangeError);function x(d){let a="",f=d.length;const E=d[0]==="-"?1:0;for(;f>=E+4;f-=3)a=`_${d.slice(f-3,f)}${a}`;return`${d.slice(0,f)}${a}`}function j(d,a,f){X(a,"offset"),(d[a]===void 0||d[a+f]===void 0)&&ee(a,d.length-(f+1))}function K(d,a,f,E,b,S){if(d>f||d<a){const $=typeof a=="bigint"?"n":"";let z;throw S>3?a===0||a===BigInt(0)?z=`>= 0${$} and < 2${$} ** ${(S+1)*8}${$}`:z=`>= -(2${$} ** ${(S+1)*8-1}${$}) and < 2 ** ${(S+1)*8-1}${$}`:z=`>= ${a}${$} and <= ${f}${$}`,new h.ERR_OUT_OF_RANGE("value",z,d)}j(E,b,S)}function X(d,a){if(typeof d!="number")throw new h.ERR_INVALID_ARG_TYPE(a,"number",d)}function ee(d,a,f){throw Math.floor(d)!==d?(X(d,f),new h.ERR_OUT_OF_RANGE(f||"offset","an integer",d)):a<0?new h.ERR_BUFFER_OUT_OF_BOUNDS:new h.ERR_OUT_OF_RANGE(f||"offset",`>= ${f?1:0} and <= ${a}`,d)}const oe=/[^+/0-9A-Za-z-_]/g;function ue(d){if(d=d.split("=")[0],d=d.trim().replace(oe,""),d.length<2)return"";for(;d.length%4!==0;)d=d+"=";return d}function Q(d,a){a=a||1/0;let f;const E=d.length;let b=null;const S=[];for(let $=0;$<E;++$){if(f=d.charCodeAt($),f>55295&&f<57344){if(!b){if(f>56319){(a-=3)>-1&&S.push(239,191,189);continue}else if($+1===E){(a-=3)>-1&&S.push(239,191,189);continue}b=f;continue}if(f<56320){(a-=3)>-1&&S.push(239,191,189),b=f;continue}f=(b-55296<<10|f-56320)+65536}else b&&(a-=3)>-1&&S.push(239,191,189);if(b=null,f<128){if((a-=1)<0)break;S.push(f)}else if(f<2048){if((a-=2)<0)break;S.push(f>>6|192,f&63|128)}else if(f<65536){if((a-=3)<0)break;S.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((a-=4)<0)break;S.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return S}function le(d){const a=[];for(let f=0;f<d.length;++f)a.push(d.charCodeAt(f)&255);return a}function we(d,a){let f,E,b;const S=[];for(let $=0;$<d.length&&!((a-=2)<0);++$)f=d.charCodeAt($),E=f>>8,b=f%256,S.push(b),S.push(E);return S}function ge(d){return r.toByteArray(ue(d))}function ce(d,a,f,E){let b;for(b=0;b<E&&!(b+f>=a.length||b>=d.length);++b)a[b+f]=d[b];return b}function ae(d,a){return d instanceof a||d!=null&&d.constructor!=null&&d.constructor.name!=null&&d.constructor.name===a.name}function Te(d){return d!==d}const ye=function(){const d="0123456789abcdef",a=new Array(256);for(let f=0;f<16;++f){const E=f*16;for(let b=0;b<16;++b)a[E+b]=d[f]+d[b]}return a}();function de(d){return typeof BigInt=="undefined"?be:d}function be(){throw new Error("BigInt not supported")}})(buffer$1),globalThis.Buffer=buffer$1.Buffer;var utf8$5={},utils$r={},support$5={},nodestream,blob;if(support$5.base64=!0,support$5.array=!0,support$5.string=!0,support$5.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",support$5.nodebuffer=typeof Buffer!="undefined",support$5.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")blob=support$5.blob=!1;else{var buffer=new ArrayBuffer(0);try{blob=support$5.blob=new Blob([buffer],{type:"application/zip"}).size===0}catch(e){try{var Builder=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,builder=new Builder;builder.append(buffer),blob=support$5.blob=builder.getBlob("application/zip").size===0}catch(r){blob=support$5.blob=!1}}}try{nodestream=support$5.nodestream=!!require("readable-stream").Readable}catch(e){nodestream=support$5.nodestream=!1}var base64$1={},utils$q=utils$r,support$4=support$5,_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64$1.encode=function(e){for(var r=[],t,n,s,l,u,o,m,_=0,p=e.length,A=p,v=utils$q.getTypeOf(e)!=="string";_<e.length;)A=p-_,v?(t=e[_++],n=_<p?e[_++]:0,s=_<p?e[_++]:0):(t=e.charCodeAt(_++),n=_<p?e.charCodeAt(_++):0,s=_<p?e.charCodeAt(_++):0),l=t>>2,u=(t&3)<<4|n>>4,o=A>1?(n&15)<<2|s>>6:64,m=A>2?s&63:64,r.push(_keyStr.charAt(l)+_keyStr.charAt(u)+_keyStr.charAt(o)+_keyStr.charAt(m));return r.join("")},base64$1.decode=function(e){var r,t,n,s,l,u,o,m=0,_=0,p="data:";if(e.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");e=e.replace(/[^A-Za-z0-9+/=]/g,"");var A=e.length*3/4;if(e.charAt(e.length-1)===_keyStr.charAt(64)&&A--,e.charAt(e.length-2)===_keyStr.charAt(64)&&A--,A%1!==0)throw new Error("Invalid base64 input, bad content length.");var v;for(support$4.uint8array?v=new Uint8Array(A|0):v=new Array(A|0);m<e.length;)s=_keyStr.indexOf(e.charAt(m++)),l=_keyStr.indexOf(e.charAt(m++)),u=_keyStr.indexOf(e.charAt(m++)),o=_keyStr.indexOf(e.charAt(m++)),r=s<<2|l>>4,t=(l&15)<<4|u>>2,n=(u&3)<<6|o,v[_++]=r,u!==64&&(v[_++]=t),o!==64&&(v[_++]=n);return v};var nodejsUtils$2={isNode:typeof Buffer!="undefined",newBufferFrom:function(e,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,r);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,r)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var r=new Buffer(e);return r.fill(0),r},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}},Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=commonjsGlobal.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(!commonjsGlobal.setImmediate&&typeof commonjsGlobal.MessageChannel!="undefined"){var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}else"document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?scheduleDrain=function(){var e=commonjsGlobal.document.createElement("script");e.onreadystatechange=function(){nextTick(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},commonjsGlobal.document.documentElement.appendChild(e)}:scheduleDrain=function(){setTimeout(nextTick,0)};var draining,queue=[];function nextTick(){draining=!0;for(var e,r,t=queue.length;t;){for(r=queue,queue=[],e=-1;++e<t;)r[e]();t=queue.length}draining=!1}var lib$2=immediate$1;function immediate$1(e){queue.push(e)===1&&!draining&&scheduleDrain()}var immediate=lib$2;function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"],lib$1=Promise$1;function Promise$1(e){if(typeof e!="function")throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,e!==INTERNAL&&safelyResolveThenable(this,e)}Promise$1.prototype.finally=function(e){if(typeof e!="function")return this;var r=this.constructor;return this.then(t,n);function t(s){function l(){return s}return r.resolve(e()).then(l)}function n(s){function l(){throw s}return r.resolve(e()).then(l)}},Promise$1.prototype.catch=function(e){return this.then(null,e)},Promise$1.prototype.then=function(e,r){if(typeof e!="function"&&this.state===FULFILLED||typeof r!="function"&&this.state===REJECTED)return this;var t=new this.constructor(INTERNAL);if(this.state!==PENDING){var n=this.state===FULFILLED?e:r;unwrap(t,n,this.outcome)}else this.queue.push(new QueueItem(t,e,r));return t};function QueueItem(e,r,t){this.promise=e,typeof r=="function"&&(this.onFulfilled=r,this.callFulfilled=this.otherCallFulfilled),typeof t=="function"&&(this.onRejected=t,this.callRejected=this.otherCallRejected)}QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)};function unwrap(e,r,t){immediate(function(){var n;try{n=r(t)}catch(s){return handlers.reject(e,s)}n===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,n)})}handlers.resolve=function(e,r){var t=tryCatch(getThen,r);if(t.status==="error")return handlers.reject(e,t.value);var n=t.value;if(n)safelyResolveThenable(e,n);else{e.state=FULFILLED,e.outcome=r;for(var s=-1,l=e.queue.length;++s<l;)e.queue[s].callFulfilled(r)}return e},handlers.reject=function(e,r){e.state=REJECTED,e.outcome=r;for(var t=-1,n=e.queue.length;++t<n;)e.queue[t].callRejected(r);return e};function getThen(e){var r=e&&e.then;if(e&&(typeof e=="object"||typeof e=="function")&&typeof r=="function")return function(){r.apply(e,arguments)}}function safelyResolveThenable(e,r){var t=!1;function n(o){t||(t=!0,handlers.reject(e,o))}function s(o){t||(t=!0,handlers.resolve(e,o))}function l(){r(s,n)}var u=tryCatch(l);u.status==="error"&&n(u.value)}function tryCatch(e,r){var t={};try{t.value=e(r),t.status="success"}catch(n){t.status="error",t.value=n}return t}Promise$1.resolve=resolve;function resolve(e){return e instanceof this?e:handlers.resolve(new this(INTERNAL),e)}Promise$1.reject=reject;function reject(e){var r=new this(INTERNAL);return handlers.reject(r,e)}Promise$1.all=all;function all(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var s=new Array(t),l=0,u=-1,o=new this(INTERNAL);++u<t;)m(e[u],u);return o;function m(_,p){r.resolve(_).then(A,function(v){n||(n=!0,handlers.reject(o,v))});function A(v){s[p]=v,++l===t&&!n&&(n=!0,handlers.resolve(o,s))}}}Promise$1.race=race;function race(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var s=-1,l=new this(INTERNAL);++s<t;)u(e[s]);return l;function u(o){r.resolve(o).then(function(m){n||(n=!0,handlers.resolve(l,m))},function(m){n||(n=!0,handlers.reject(l,m))})}}var ES6Promise=null;typeof Promise!="undefined"?ES6Promise=Promise:ES6Promise=lib$1;var external$3={Promise:ES6Promise};(function(e,r){if(e.setImmediate)return;var t=1,n={},s=!1,l=e.document,u;function o(D){typeof D!="function"&&(D=new Function(""+D));for(var B=new Array(arguments.length-1),R=0;R<B.length;R++)B[R]=arguments[R+1];var O={callback:D,args:B};return n[t]=O,u(t),t++}function m(D){delete n[D]}function _(D){var B=D.callback,R=D.args;switch(R.length){case 0:B();break;case 1:B(R[0]);break;case 2:B(R[0],R[1]);break;case 3:B(R[0],R[1],R[2]);break;default:B.apply(r,R);break}}function p(D){if(s)setTimeout(p,0,D);else{var B=n[D];if(B){s=!0;try{_(B)}finally{m(D),s=!1}}}}function A(){u=function(D){setTimeout(function(){p(D)})}}function v(){if(e.postMessage&&!e.importScripts){var D=!0,B=e.onmessage;return e.onmessage=function(){D=!1},e.postMessage("","*"),e.onmessage=B,D}}function w(){var D="setImmediate$"+Math.random()+"$",B=function(R){R.source===e&&typeof R.data=="string"&&R.data.indexOf(D)===0&&p(+R.data.slice(D.length))};e.addEventListener?e.addEventListener("message",B,!1):e.attachEvent("onmessage",B),u=function(R){e.postMessage(D+R,"*")}}function T(){var D=new MessageChannel;D.port1.onmessage=function(B){var R=B.data;p(R)},u=function(B){D.port2.postMessage(B)}}function I(){var D=l.documentElement;u=function(B){var R=l.createElement("script");R.onreadystatechange=function(){p(B),R.onreadystatechange=null,D.removeChild(R),R=null},D.appendChild(R)}}function N(){u=function(D){setTimeout(p,0,D)}}var k=Object.getPrototypeOf&&Object.getPrototypeOf(e);k=k&&k.setTimeout?k:e,{}.toString.call(e.undefined)==="[object undefined]"?A():v()?w():e.MessageChannel?T():l&&"onreadystatechange"in l.createElement("script")?I():N(),k.setImmediate=o,k.clearImmediate=m})(typeof self=="undefined"?commonjsGlobal:self),function(e){var r=support$5,t=base64$1,n=nodejsUtils$2,s=external$3;function l(v){var w=null;return r.uint8array?w=new Uint8Array(v.length):w=new Array(v.length),o(v,w)}e.newBlob=function(v,w){e.checkSupport("blob");try{return new Blob([v],{type:w})}catch(N){try{var T=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,I=new T;return I.append(v),I.getBlob(w)}catch(k){throw new Error("Bug : can't construct the Blob.")}}};function u(v){return v}function o(v,w){for(var T=0;T<v.length;++T)w[T]=v.charCodeAt(T)&255;return w}var m={stringifyByChunk:function(v,w,T){var I=[],N=0,k=v.length;if(k<=T)return String.fromCharCode.apply(null,v);for(;N<k;)w==="array"||w==="nodebuffer"?I.push(String.fromCharCode.apply(null,v.slice(N,Math.min(N+T,k)))):I.push(String.fromCharCode.apply(null,v.subarray(N,Math.min(N+T,k)))),N+=T;return I.join("")},stringifyByChar:function(v){for(var w="",T=0;T<v.length;T++)w+=String.fromCharCode(v[T]);return w},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(v){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,n.allocBuffer(1)).length===1}catch(v){return!1}}()}};function _(v){var w=65536,T=e.getTypeOf(v),I=!0;if(T==="uint8array"?I=m.applyCanBeUsed.uint8array:T==="nodebuffer"&&(I=m.applyCanBeUsed.nodebuffer),I)for(;w>1;)try{return m.stringifyByChunk(v,T,w)}catch(N){w=Math.floor(w/2)}return m.stringifyByChar(v)}e.applyFromCharCode=_;function p(v,w){for(var T=0;T<v.length;T++)w[T]=v[T];return w}var A={};A.string={string:u,array:function(v){return o(v,new Array(v.length))},arraybuffer:function(v){return A.string.uint8array(v).buffer},uint8array:function(v){return o(v,new Uint8Array(v.length))},nodebuffer:function(v){return o(v,n.allocBuffer(v.length))}},A.array={string:_,array:u,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return n.newBufferFrom(v)}},A.arraybuffer={string:function(v){return _(new Uint8Array(v))},array:function(v){return p(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:u,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return n.newBufferFrom(new Uint8Array(v))}},A.uint8array={string:_,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:u,nodebuffer:function(v){return n.newBufferFrom(v)}},A.nodebuffer={string:_,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return A.nodebuffer.uint8array(v).buffer},uint8array:function(v){return p(v,new Uint8Array(v.length))},nodebuffer:u},e.transformTo=function(v,w){if(w||(w=""),!v)return w;e.checkSupport(v);var T=e.getTypeOf(w),I=A[T][v](w);return I},e.resolve=function(v){for(var w=v.split("/"),T=[],I=0;I<w.length;I++){var N=w[I];N==="."||N===""&&I!==0&&I!==w.length-1||(N===".."?T.pop():T.push(N))}return T.join("/")},e.getTypeOf=function(v){if(typeof v=="string")return"string";if(Object.prototype.toString.call(v)==="[object Array]")return"array";if(r.nodebuffer&&n.isBuffer(v))return"nodebuffer";if(r.uint8array&&v instanceof Uint8Array)return"uint8array";if(r.arraybuffer&&v instanceof ArrayBuffer)return"arraybuffer"},e.checkSupport=function(v){var w=r[v.toLowerCase()];if(!w)throw new Error(v+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(v){var w="",T,I;for(I=0;I<(v||"").length;I++)T=v.charCodeAt(I),w+="\\x"+(T<16?"0":"")+T.toString(16).toUpperCase();return w},e.delay=function(v,w,T){setImmediate(function(){v.apply(T||null,w||[])})},e.inherits=function(v,w){var T=function(){};T.prototype=w.prototype,v.prototype=new T},e.extend=function(){var v={},w,T;for(w=0;w<arguments.length;w++)for(T in arguments[w])Object.prototype.hasOwnProperty.call(arguments[w],T)&&typeof v[T]=="undefined"&&(v[T]=arguments[w][T]);return v},e.prepareContent=function(v,w,T,I,N){var k=s.Promise.resolve(w).then(function(D){var B=r.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1);return B&&typeof FileReader!="undefined"?new s.Promise(function(R,O){var P=new FileReader;P.onload=function(L){R(L.target.result)},P.onerror=function(L){O(L.target.error)},P.readAsArrayBuffer(D)}):D});return k.then(function(D){var B=e.getTypeOf(D);return B?(B==="arraybuffer"?D=e.transformTo("uint8array",D):B==="string"&&(N?D=t.decode(D):T&&I!==!0&&(D=l(D))),D):s.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}}(utils$r);function GenericWorker$b(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker$b.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return this.isFinished?!1:(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,r){return this._listeners[e].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,r){if(this._listeners[e])for(var t=0;t<this._listeners[e].length;t++)this._listeners[e][t].call(this,r)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var r=this;return e.on("data",function(t){r.processChunk(t)}),e.on("end",function(){r.end()}),e.on("error",function(t){r.error(t)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,r){return this.extraStreamInfo[e]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)!Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)||(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};var GenericWorker_1=GenericWorker$b;(function(e){for(var r=utils$r,t=support$5,n=nodejsUtils$2,s=GenericWorker_1,l=new Array(256),u=0;u<256;u++)l[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;l[254]=l[254]=1;var o=function(v){var w,T,I,N,k,D=v.length,B=0;for(N=0;N<D;N++)T=v.charCodeAt(N),(T&64512)===55296&&N+1<D&&(I=v.charCodeAt(N+1),(I&64512)===56320&&(T=65536+(T-55296<<10)+(I-56320),N++)),B+=T<128?1:T<2048?2:T<65536?3:4;for(t.uint8array?w=new Uint8Array(B):w=new Array(B),k=0,N=0;k<B;N++)T=v.charCodeAt(N),(T&64512)===55296&&N+1<D&&(I=v.charCodeAt(N+1),(I&64512)===56320&&(T=65536+(T-55296<<10)+(I-56320),N++)),T<128?w[k++]=T:T<2048?(w[k++]=192|T>>>6,w[k++]=128|T&63):T<65536?(w[k++]=224|T>>>12,w[k++]=128|T>>>6&63,w[k++]=128|T&63):(w[k++]=240|T>>>18,w[k++]=128|T>>>12&63,w[k++]=128|T>>>6&63,w[k++]=128|T&63);return w},m=function(v,w){var T;for(w=w||v.length,w>v.length&&(w=v.length),T=w-1;T>=0&&(v[T]&192)===128;)T--;return T<0||T===0?w:T+l[v[T]]>w?T:w},_=function(v){var w,T,I,N,k=v.length,D=new Array(k*2);for(T=0,w=0;w<k;){if(I=v[w++],I<128){D[T++]=I;continue}if(N=l[I],N>4){D[T++]=65533,w+=N-1;continue}for(I&=N===2?31:N===3?15:7;N>1&&w<k;)I=I<<6|v[w++]&63,N--;if(N>1){D[T++]=65533;continue}I<65536?D[T++]=I:(I-=65536,D[T++]=55296|I>>10&1023,D[T++]=56320|I&1023)}return D.length!==T&&(D.subarray?D=D.subarray(0,T):D.length=T),r.applyFromCharCode(D)};e.utf8encode=function(w){return t.nodebuffer?n.newBufferFrom(w,"utf-8"):o(w)},e.utf8decode=function(w){return t.nodebuffer?r.transformTo("nodebuffer",w).toString("utf-8"):(w=r.transformTo(t.uint8array?"uint8array":"array",w),_(w))};function p(){s.call(this,"utf-8 decode"),this.leftOver=null}r.inherits(p,s),p.prototype.processChunk=function(v){var w=r.transformTo(t.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(t.uint8array){var T=w;w=new Uint8Array(T.length+this.leftOver.length),w.set(this.leftOver,0),w.set(T,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var I=m(w),N=w;I!==w.length&&(t.uint8array?(N=w.subarray(0,I),this.leftOver=w.subarray(I,w.length)):(N=w.slice(0,I),this.leftOver=w.slice(I,w.length))),this.push({data:e.utf8decode(N),meta:v.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=p;function A(){s.call(this,"utf-8 encode")}r.inherits(A,s),A.prototype.processChunk=function(v){this.push({data:e.utf8encode(v.data),meta:v.meta})},e.Utf8EncodeWorker=A})(utf8$5);var GenericWorker$a=GenericWorker_1,utils$p=utils$r;function ConvertWorker$1(e){GenericWorker$a.call(this,"ConvertWorker to "+e),this.destType=e}utils$p.inherits(ConvertWorker$1,GenericWorker$a),ConvertWorker$1.prototype.processChunk=function(e){this.push({data:utils$p.transformTo(this.destType,e.data),meta:e.meta})};var ConvertWorker_1=ConvertWorker$1,utils$o=utils$r,ConvertWorker=ConvertWorker_1,GenericWorker$9=GenericWorker_1,base64=base64$1,support$3=support$5,external$2=external$3,NodejsStreamOutputAdapter=null;if(support$3.nodestream)try{NodejsStreamOutputAdapter=require("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function transformZipOutput(e,r,t){switch(e){case"blob":return utils$o.newBlob(utils$o.transformTo("arraybuffer",r),t);case"base64":return base64.encode(r);default:return utils$o.transformTo(e,r)}}function concat(e,r){var t,n=0,s=null,l=0;for(t=0;t<r.length;t++)l+=r[t].length;switch(e){case"string":return r.join("");case"array":return Array.prototype.concat.apply([],r);case"uint8array":for(s=new Uint8Array(l),t=0;t<r.length;t++)s.set(r[t],n),n+=r[t].length;return s;case"nodebuffer":return Buffer.concat(r);default:throw new Error("concat : unsupported type '"+e+"'")}}function accumulate(e,r){return new external$2.Promise(function(t,n){var s=[],l=e._internalType,u=e._outputType,o=e._mimeType;e.on("data",function(m,_){s.push(m),r&&r(_)}).on("error",function(m){s=[],n(m)}).on("end",function(){try{var m=transformZipOutput(u,concat(l,s),o);t(m)}catch(_){n(_)}s=[]}).resume()})}function StreamHelper$2(e,r,t){var n=r;switch(r){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string";break}try{this._internalType=n,this._outputType=r,this._mimeType=t,utils$o.checkSupport(n),this._worker=e.pipe(new ConvertWorker(n)),e.lock()}catch(s){this._worker=new GenericWorker$9("error"),this._worker.error(s)}}StreamHelper$2.prototype={accumulate:function(e){return accumulate(this,e)},on:function(e,r){var t=this;return e==="data"?this._worker.on(e,function(n){r.call(t,n.data,n.meta)}):this._worker.on(e,function(){utils$o.delay(r,arguments,t)}),this},resume:function(){return utils$o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(utils$o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new NodejsStreamOutputAdapter(this,{objectMode:this._outputType!=="nodebuffer"},e)}};var StreamHelper_1=StreamHelper$2,defaults$1={};defaults$1.base64=!1,defaults$1.binary=!1,defaults$1.dir=!1,defaults$1.createFolders=!0,defaults$1.date=null,defaults$1.compression=null,defaults$1.compressionOptions=null,defaults$1.comment=null,defaults$1.unixPermissions=null,defaults$1.dosPermissions=null;var utils$n=utils$r,GenericWorker$8=GenericWorker_1,DEFAULT_BLOCK_SIZE=16*1024;function DataWorker$2(e){GenericWorker$8.call(this,"DataWorker");var r=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(t){r.dataIsReady=!0,r.data=t,r.max=t&&t.length||0,r.type=utils$n.getTypeOf(t),r.isPaused||r._tickAndRepeat()},function(t){r.error(t)})}utils$n.inherits(DataWorker$2,GenericWorker$8),DataWorker$2.prototype.cleanUp=function(){GenericWorker$8.prototype.cleanUp.call(this),this.data=null},DataWorker$2.prototype.resume=function(){return GenericWorker$8.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,utils$n.delay(this._tickAndRepeat,[],this)),!0):!1},DataWorker$2.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(utils$n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker$2.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=DEFAULT_BLOCK_SIZE,r=null,t=Math.min(this.max,this.index+e);if(this.index>=this.max)return this.end();switch(this.type){case"string":r=this.data.substring(this.index,t);break;case"uint8array":r=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":r=this.data.slice(this.index,t);break}return this.index=t,this.push({data:r,meta:{percent:this.max?this.index/this.max*100:0}})};var DataWorker_1=DataWorker$2,utils$m=utils$r;function makeTable$1(){for(var e,r=[],t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r}var crcTable$1=makeTable$1();function crc32$5(e,r,t,n){var s=crcTable$1,l=n+t;e=e^-1;for(var u=n;u<l;u++)e=e>>>8^s[(e^r[u])&255];return e^-1}function crc32str(e,r,t,n){var s=crcTable$1,l=n+t;e=e^-1;for(var u=n;u<l;u++)e=e>>>8^s[(e^r.charCodeAt(u))&255];return e^-1}var crc32_1$1=function(r,t){if(typeof r=="undefined"||!r.length)return 0;var n=utils$m.getTypeOf(r)!=="string";return n?crc32$5(t|0,r,r.length,0):crc32str(t|0,r,r.length,0)},GenericWorker$7=GenericWorker_1,crc32$4=crc32_1$1,utils$l=utils$r;function Crc32Probe$2(){GenericWorker$7.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}utils$l.inherits(Crc32Probe$2,GenericWorker$7),Crc32Probe$2.prototype.processChunk=function(e){this.streamInfo.crc32=crc32$4(e.data,this.streamInfo.crc32||0),this.push(e)};var Crc32Probe_1=Crc32Probe$2,utils$k=utils$r,GenericWorker$6=GenericWorker_1;function DataLengthProbe$1(e){GenericWorker$6.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}utils$k.inherits(DataLengthProbe$1,GenericWorker$6),DataLengthProbe$1.prototype.processChunk=function(e){if(e){var r=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=r+e.data.length}GenericWorker$6.prototype.processChunk.call(this,e)};var DataLengthProbe_1=DataLengthProbe$1,external$1=external$3,DataWorker$1=DataWorker_1,Crc32Probe$1=Crc32Probe_1,DataLengthProbe=DataLengthProbe_1;function CompressedObject$3(e,r,t,n,s){this.compressedSize=e,this.uncompressedSize=r,this.crc32=t,this.compression=n,this.compressedContent=s}CompressedObject$3.prototype={getContentWorker:function(){var e=new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new DataLengthProbe("data_length")),r=this;return e.on("end",function(){if(this.streamInfo.data_length!==r.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject$3.createWorkerFrom=function(e,r,t){return e.pipe(new Crc32Probe$1).pipe(new DataLengthProbe("uncompressedSize")).pipe(r.compressWorker(t)).pipe(new DataLengthProbe("compressedSize")).withStreamInfo("compression",r)};var compressedObject=CompressedObject$3,StreamHelper$1=StreamHelper_1,DataWorker=DataWorker_1,utf8$4=utf8$5,CompressedObject$2=compressedObject,GenericWorker$5=GenericWorker_1,ZipObject$1=function(e,r,t){this.name=e,this.dir=t.dir,this.date=t.date,this.comment=t.comment,this.unixPermissions=t.unixPermissions,this.dosPermissions=t.dosPermissions,this._data=r,this._dataBinary=t.binary,this.options={compression:t.compression,compressionOptions:t.compressionOptions}};ZipObject$1.prototype={internalStream:function(e){var r=null,t="string";try{if(!e)throw new Error("No output type specified.");t=e.toLowerCase();var n=t==="string"||t==="text";(t==="binarystring"||t==="text")&&(t="string"),r=this._decompressWorker();var s=!this._dataBinary;s&&!n&&(r=r.pipe(new utf8$4.Utf8EncodeWorker)),!s&&n&&(r=r.pipe(new utf8$4.Utf8DecodeWorker))}catch(l){r=new GenericWorker$5("error"),r.error(l)}return new StreamHelper$1(r,t,"")},async:function(e,r){return this.internalStream(e).accumulate(r)},nodeStream:function(e,r){return this.internalStream(e||"nodebuffer").toNodejsStream(r)},_compressWorker:function(e,r){if(this._data instanceof CompressedObject$2&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var t=this._decompressWorker();return this._dataBinary||(t=t.pipe(new utf8$4.Utf8EncodeWorker)),CompressedObject$2.createWorkerFrom(t,e,r)},_decompressWorker:function(){return this._data instanceof CompressedObject$2?this._data.getContentWorker():this._data instanceof GenericWorker$5?this._data:new DataWorker(this._data)}};for(var removedMethods=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i=0;i<removedMethods.length;i++)ZipObject$1.prototype[removedMethods[i]]=removedFn;var zipObject=ZipObject$1,generate$1={},compressions$2={},flate={},common={};(function(e){var r=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function t(l,u){return Object.prototype.hasOwnProperty.call(l,u)}e.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var o=u.shift();if(!!o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var m in o)t(o,m)&&(l[m]=o[m])}}return l},e.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var n={arraySet:function(l,u,o,m,_){if(u.subarray&&l.subarray){l.set(u.subarray(o,o+m),_);return}for(var p=0;p<m;p++)l[_+p]=u[o+p]},flattenChunks:function(l){var u,o,m,_,p,A;for(m=0,u=0,o=l.length;u<o;u++)m+=l[u].length;for(A=new Uint8Array(m),_=0,u=0,o=l.length;u<o;u++)p=l[u],A.set(p,_),_+=p.length;return A}},s={arraySet:function(l,u,o,m,_){for(var p=0;p<m;p++)l[_+p]=u[o+p]},flattenChunks:function(l){return[].concat.apply([],l)}};e.setTyped=function(l){l?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(r)})(common);var deflate$4={},deflate$3={},trees$1={},utils$j=common,Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(e){for(var r=e.length;--r>=0;)e[r]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(e,r,t,n,s){this.static_tree=e,this.extra_bits=r,this.extra_base=t,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(e,r){this.dyn_tree=e,this.max_code=0,this.stat_desc=r}function d_code(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]}function put_short(e,r){e.pending_buf[e.pending++]=r&255,e.pending_buf[e.pending++]=r>>>8&255}function send_bits(e,r,t){e.bi_valid>Buf_size-t?(e.bi_buf|=r<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=r>>Buf_size-e.bi_valid,e.bi_valid+=t-Buf_size):(e.bi_buf|=r<<e.bi_valid&65535,e.bi_valid+=t)}function send_code(e,r,t){send_bits(e,t[r*2],t[r*2+1])}function bi_reverse(e,r){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--r>0);return t>>>1}function bi_flush(e){e.bi_valid===16?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function gen_bitlen(e,r){var t=r.dyn_tree,n=r.max_code,s=r.stat_desc.static_tree,l=r.stat_desc.has_stree,u=r.stat_desc.extra_bits,o=r.stat_desc.extra_base,m=r.stat_desc.max_length,_,p,A,v,w,T,I=0;for(v=0;v<=MAX_BITS$1;v++)e.bl_count[v]=0;for(t[e.heap[e.heap_max]*2+1]=0,_=e.heap_max+1;_<HEAP_SIZE$1;_++)p=e.heap[_],v=t[t[p*2+1]*2+1]+1,v>m&&(v=m,I++),t[p*2+1]=v,!(p>n)&&(e.bl_count[v]++,w=0,p>=o&&(w=u[p-o]),T=t[p*2],e.opt_len+=T*(v+w),l&&(e.static_len+=T*(s[p*2+1]+w)));if(I!==0){do{for(v=m-1;e.bl_count[v]===0;)v--;e.bl_count[v]--,e.bl_count[v+1]+=2,e.bl_count[m]--,I-=2}while(I>0);for(v=m;v!==0;v--)for(p=e.bl_count[v];p!==0;)A=e.heap[--_],!(A>n)&&(t[A*2+1]!==v&&(e.opt_len+=(v-t[A*2+1])*t[A*2],t[A*2+1]=v),p--)}}function gen_codes(e,r,t){var n=new Array(MAX_BITS$1+1),s=0,l,u;for(l=1;l<=MAX_BITS$1;l++)n[l]=s=s+t[l-1]<<1;for(u=0;u<=r;u++){var o=e[u*2+1];o!==0&&(e[u*2]=bi_reverse(n[o]++,o))}}function tr_static_init(){var e,r,t,n,s,l=new Array(MAX_BITS$1+1);for(t=0,n=0;n<LENGTH_CODES$1-1;n++)for(base_length[n]=t,e=0;e<1<<extra_lbits[n];e++)_length_code[t++]=n;for(_length_code[t-1]=n,s=0,n=0;n<16;n++)for(base_dist[n]=s,e=0;e<1<<extra_dbits[n];e++)_dist_code[s++]=n;for(s>>=7;n<D_CODES$1;n++)for(base_dist[n]=s<<7,e=0;e<1<<extra_dbits[n]-7;e++)_dist_code[256+s++]=n;for(r=0;r<=MAX_BITS$1;r++)l[r]=0;for(e=0;e<=143;)static_ltree[e*2+1]=8,e++,l[8]++;for(;e<=255;)static_ltree[e*2+1]=9,e++,l[9]++;for(;e<=279;)static_ltree[e*2+1]=7,e++,l[7]++;for(;e<=287;)static_ltree[e*2+1]=8,e++,l[8]++;for(gen_codes(static_ltree,L_CODES$1+1,l),e=0;e<D_CODES$1;e++)static_dtree[e*2+1]=5,static_dtree[e*2]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(e){var r;for(r=0;r<L_CODES$1;r++)e.dyn_ltree[r*2]=0;for(r=0;r<D_CODES$1;r++)e.dyn_dtree[r*2]=0;for(r=0;r<BL_CODES$1;r++)e.bl_tree[r*2]=0;e.dyn_ltree[END_BLOCK*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function bi_windup(e){e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function copy_block(e,r,t,n){bi_windup(e),n&&(put_short(e,t),put_short(e,~t)),utils$j.arraySet(e.pending_buf,e.window,r,t,e.pending),e.pending+=t}function smaller(e,r,t,n){var s=r*2,l=t*2;return e[s]<e[l]||e[s]===e[l]&&n[r]<=n[t]}function pqdownheap(e,r,t){for(var n=e.heap[t],s=t<<1;s<=e.heap_len&&(s<e.heap_len&&smaller(r,e.heap[s+1],e.heap[s],e.depth)&&s++,!smaller(r,n,e.heap[s],e.depth));)e.heap[t]=e.heap[s],t=s,s<<=1;e.heap[t]=n}function compress_block(e,r,t){var n,s,l=0,u,o;if(e.last_lit!==0)do n=e.pending_buf[e.d_buf+l*2]<<8|e.pending_buf[e.d_buf+l*2+1],s=e.pending_buf[e.l_buf+l],l++,n===0?send_code(e,s,r):(u=_length_code[s],send_code(e,u+LITERALS$1+1,r),o=extra_lbits[u],o!==0&&(s-=base_length[u],send_bits(e,s,o)),n--,u=d_code(n),send_code(e,u,t),o=extra_dbits[u],o!==0&&(n-=base_dist[u],send_bits(e,n,o)));while(l<e.last_lit);send_code(e,END_BLOCK,r)}function build_tree(e,r){var t=r.dyn_tree,n=r.stat_desc.static_tree,s=r.stat_desc.has_stree,l=r.stat_desc.elems,u,o,m=-1,_;for(e.heap_len=0,e.heap_max=HEAP_SIZE$1,u=0;u<l;u++)t[u*2]!==0?(e.heap[++e.heap_len]=m=u,e.depth[u]=0):t[u*2+1]=0;for(;e.heap_len<2;)_=e.heap[++e.heap_len]=m<2?++m:0,t[_*2]=1,e.depth[_]=0,e.opt_len--,s&&(e.static_len-=n[_*2+1]);for(r.max_code=m,u=e.heap_len>>1;u>=1;u--)pqdownheap(e,t,u);_=l;do u=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,t,1),o=e.heap[1],e.heap[--e.heap_max]=u,e.heap[--e.heap_max]=o,t[_*2]=t[u*2]+t[o*2],e.depth[_]=(e.depth[u]>=e.depth[o]?e.depth[u]:e.depth[o])+1,t[u*2+1]=t[o*2+1]=_,e.heap[1]=_++,pqdownheap(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,r),gen_codes(t,m,e.bl_count)}function scan_tree(e,r,t){var n,s=-1,l,u=r[0*2+1],o=0,m=7,_=4;for(u===0&&(m=138,_=3),r[(t+1)*2+1]=65535,n=0;n<=t;n++)l=u,u=r[(n+1)*2+1],!(++o<m&&l===u)&&(o<_?e.bl_tree[l*2]+=o:l!==0?(l!==s&&e.bl_tree[l*2]++,e.bl_tree[REP_3_6*2]++):o<=10?e.bl_tree[REPZ_3_10*2]++:e.bl_tree[REPZ_11_138*2]++,o=0,s=l,u===0?(m=138,_=3):l===u?(m=6,_=3):(m=7,_=4))}function send_tree(e,r,t){var n,s=-1,l,u=r[0*2+1],o=0,m=7,_=4;for(u===0&&(m=138,_=3),n=0;n<=t;n++)if(l=u,u=r[(n+1)*2+1],!(++o<m&&l===u)){if(o<_)do send_code(e,l,e.bl_tree);while(--o!==0);else l!==0?(l!==s&&(send_code(e,l,e.bl_tree),o--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,o-3,2)):o<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,o-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,o-11,7));o=0,s=l,u===0?(m=138,_=3):l===u?(m=6,_=3):(m=7,_=4)}}function build_bl_tree(e){var r;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),r=BL_CODES$1-1;r>=3&&e.bl_tree[bl_order[r]*2+1]===0;r--);return e.opt_len+=3*(r+1)+5+5+4,r}function send_all_trees(e,r,t,n){var s;for(send_bits(e,r-257,5),send_bits(e,t-1,5),send_bits(e,n-4,4),s=0;s<n;s++)send_bits(e,e.bl_tree[bl_order[s]*2+1],3);send_tree(e,e.dyn_ltree,r-1),send_tree(e,e.dyn_dtree,t-1)}function detect_data_type(e){var r=4093624447,t;for(t=0;t<=31;t++,r>>>=1)if(r&1&&e.dyn_ltree[t*2]!==0)return Z_BINARY;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Z_TEXT;for(t=32;t<LITERALS$1;t++)if(e.dyn_ltree[t*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(e){static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)}function _tr_stored_block(e,r,t,n){send_bits(e,(STORED_BLOCK<<1)+(n?1:0),3),copy_block(e,r,t,!0)}function _tr_align(e){send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree),bi_flush(e)}function _tr_flush_block(e,r,t,n){var s,l,u=0;e.level>0?(e.strm.data_type===Z_UNKNOWN$1&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),u=build_bl_tree(e),s=e.opt_len+3+7>>>3,l=e.static_len+3+7>>>3,l<=s&&(s=l)):s=l=t+5,t+4<=s&&r!==-1?_tr_stored_block(e,r,t,n):e.strategy===Z_FIXED$1||l===s?(send_bits(e,(STATIC_TREES<<1)+(n?1:0),3),compress_block(e,static_ltree,static_dtree)):(send_bits(e,(DYN_TREES<<1)+(n?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,u+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),n&&bi_windup(e)}function _tr_tally(e,r,t){return e.pending_buf[e.d_buf+e.last_lit*2]=r>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=r&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,r===0?e.dyn_ltree[t*2]++:(e.matches++,r--,e.dyn_ltree[(_length_code[t]+LITERALS$1+1)*2]++,e.dyn_dtree[d_code(r)*2]++),e.last_lit===e.lit_bufsize-1}trees$1._tr_init=_tr_init,trees$1._tr_stored_block=_tr_stored_block,trees$1._tr_flush_block=_tr_flush_block,trees$1._tr_tally=_tr_tally,trees$1._tr_align=_tr_align;function adler32$2(e,r,t,n){for(var s=e&65535|0,l=e>>>16&65535|0,u=0;t!==0;){u=t>2e3?2e3:t,t-=u;do s=s+r[n++]|0,l=l+s|0;while(--u);s%=65521,l%=65521}return s|l<<16|0}var adler32_1=adler32$2;function makeTable(){for(var e,r=[],t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r}var crcTable=makeTable();function crc32$3(e,r,t,n){var s=crcTable,l=n+t;e^=-1;for(var u=n;u<l;u++)e=e>>>8^s[(e^r[u])&255];return e^-1}var crc32_1=crc32$3,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},utils$i=common,trees=trees$1,adler32$1=adler32_1,crc32$2=crc32_1,msg$2=messages,Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(e,r){return e.msg=msg$2[r],r}function rank(e){return(e<<1)-(e>4?9:0)}function zero(e){for(var r=e.length;--r>=0;)e[r]=0}function flush_pending(e){var r=e.state,t=r.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(utils$i.arraySet(e.output,r.pending_buf,r.pending_out,t,e.next_out),e.next_out+=t,r.pending_out+=t,e.total_out+=t,e.avail_out-=t,r.pending-=t,r.pending===0&&(r.pending_out=0))}function flush_block_only(e,r){trees._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r),e.block_start=e.strstart,flush_pending(e.strm)}function put_byte(e,r){e.pending_buf[e.pending++]=r}function putShortMSB(e,r){e.pending_buf[e.pending++]=r>>>8&255,e.pending_buf[e.pending++]=r&255}function read_buf(e,r,t,n){var s=e.avail_in;return s>n&&(s=n),s===0?0:(e.avail_in-=s,utils$i.arraySet(r,e.input,e.next_in,s,t),e.state.wrap===1?e.adler=adler32$1(e.adler,r,s,t):e.state.wrap===2&&(e.adler=crc32$2(e.adler,r,s,t)),e.next_in+=s,e.total_in+=s,s)}function longest_match(e,r){var t=e.max_chain_length,n=e.strstart,s,l,u=e.prev_length,o=e.nice_match,m=e.strstart>e.w_size-MIN_LOOKAHEAD?e.strstart-(e.w_size-MIN_LOOKAHEAD):0,_=e.window,p=e.w_mask,A=e.prev,v=e.strstart+MAX_MATCH,w=_[n+u-1],T=_[n+u];e.prev_length>=e.good_match&&(t>>=2),o>e.lookahead&&(o=e.lookahead);do if(s=r,!(_[s+u]!==T||_[s+u-1]!==w||_[s]!==_[n]||_[++s]!==_[n+1])){n+=2,s++;do;while(_[++n]===_[++s]&&_[++n]===_[++s]&&_[++n]===_[++s]&&_[++n]===_[++s]&&_[++n]===_[++s]&&_[++n]===_[++s]&&_[++n]===_[++s]&&_[++n]===_[++s]&&n<v);if(l=MAX_MATCH-(v-n),n=v-MAX_MATCH,l>u){if(e.match_start=r,u=l,l>=o)break;w=_[n+u-1],T=_[n+u]}}while((r=A[r&p])>m&&--t!==0);return u<=e.lookahead?u:e.lookahead}function fill_window(e){var r=e.w_size,t,n,s,l,u;do{if(l=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-MIN_LOOKAHEAD)){utils$i.arraySet(e.window,e.window,r,r,0),e.match_start-=r,e.strstart-=r,e.block_start-=r,n=e.hash_size,t=n;do s=e.head[--t],e.head[t]=s>=r?s-r:0;while(--n);n=r,t=n;do s=e.prev[--t],e.prev[t]=s>=r?s-r:0;while(--n);l+=r}if(e.strm.avail_in===0)break;if(n=read_buf(e.strm,e.window,e.strstart+e.lookahead,l),e.lookahead+=n,e.lookahead+e.insert>=MIN_MATCH)for(u=e.strstart-e.insert,e.ins_h=e.window[u],e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+MIN_MATCH-1])&e.hash_mask,e.prev[u&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=u,u++,e.insert--,!(e.lookahead+e.insert<MIN_MATCH)););}while(e.lookahead<MIN_LOOKAHEAD&&e.strm.avail_in!==0)}function deflate_stored(e,r){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fill_window(e),e.lookahead===0&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+t;if((e.strstart===0||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,flush_block_only(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-MIN_LOOKAHEAD&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(e.strstart>e.block_start&&(flush_block_only(e,!1),e.strm.avail_out===0),BS_NEED_MORE)}function deflate_fast(e,r){for(var t,n;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(t=0,e.lookahead>=MIN_MATCH&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,t)),e.match_length>=MIN_MATCH)if(n=trees._tr_tally(e,e.strstart-e.match_start,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=MIN_MATCH){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(e,r){for(var t,n,s;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(t=0,e.lookahead>=MIN_MATCH&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=MIN_MATCH-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,t),e.match_length<=5&&(e.strategy===Z_FILTERED||e.match_length===MIN_MATCH&&e.strstart-e.match_start>4096)&&(e.match_length=MIN_MATCH-1)),e.prev_length>=MIN_MATCH&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-MIN_MATCH,n=trees._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-MIN_MATCH),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=MIN_MATCH-1,e.strstart++,n&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}else if(e.match_available){if(n=trees._tr_tally(e,0,e.window[e.strstart-1]),n&&flush_block_only(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=trees._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(e,r){for(var t,n,s,l,u=e.window;;){if(e.lookahead<=MAX_MATCH){if(fill_window(e),e.lookahead<=MAX_MATCH&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=MIN_MATCH&&e.strstart>0&&(s=e.strstart-1,n=u[s],n===u[++s]&&n===u[++s]&&n===u[++s])){l=e.strstart+MAX_MATCH;do;while(n===u[++s]&&n===u[++s]&&n===u[++s]&&n===u[++s]&&n===u[++s]&&n===u[++s]&&n===u[++s]&&n===u[++s]&&s<l);e.match_length=MAX_MATCH-(l-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=MIN_MATCH?(t=trees._tr_tally(e,1,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(e,r){for(var t;;){if(e.lookahead===0&&(fill_window(e),e.lookahead===0)){if(r===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(e.match_length=0,t=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(e,r,t,n,s){this.good_length=e,this.max_lazy=r,this.nice_length=t,this.max_chain=n,this.func=s}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(e){e.window_size=2*e.w_size,zero(e.head),e.max_lazy_match=configuration_table[e.level].max_lazy,e.good_match=configuration_table[e.level].good_length,e.nice_match=configuration_table[e.level].nice_length,e.max_chain_length=configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=MIN_MATCH-1,e.match_available=0,e.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$i.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$i.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$i.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$i.Buf16(MAX_BITS+1),this.heap=new utils$i.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$i.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(e){var r;return!e||!e.state?err(e,Z_STREAM_ERROR$1):(e.total_in=e.total_out=0,e.data_type=Z_UNKNOWN,r=e.state,r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap?INIT_STATE:BUSY_STATE,e.adler=r.wrap===2?0:1,r.last_flush=Z_NO_FLUSH$1,trees._tr_init(r),Z_OK$2)}function deflateReset(e){var r=deflateResetKeep(e);return r===Z_OK$2&&lm_init(e.state),r}function deflateSetHeader(e,r){return!e||!e.state||e.state.wrap!==2?Z_STREAM_ERROR$1:(e.state.gzhead=r,Z_OK$2)}function deflateInit2(e,r,t,n,s,l){if(!e)return Z_STREAM_ERROR$1;var u=1;if(r===Z_DEFAULT_COMPRESSION$1&&(r=6),n<0?(u=0,n=-n):n>15&&(u=2,n-=16),s<1||s>MAX_MEM_LEVEL||t!==Z_DEFLATED$2||n<8||n>15||r<0||r>9||l<0||l>Z_FIXED)return err(e,Z_STREAM_ERROR$1);n===8&&(n=9);var o=new DeflateState;return e.state=o,o.strm=e,o.wrap=u,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=s+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+MIN_MATCH-1)/MIN_MATCH),o.window=new utils$i.Buf8(o.w_size*2),o.head=new utils$i.Buf16(o.hash_size),o.prev=new utils$i.Buf16(o.w_size),o.lit_bufsize=1<<s+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new utils$i.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=r,o.strategy=l,o.method=t,deflateReset(e)}function deflateInit(e,r){return deflateInit2(e,r,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(e,r){var t,n,s,l;if(!e||!e.state||r>Z_BLOCK$1||r<0)return e?err(e,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(n=e.state,!e.output||!e.input&&e.avail_in!==0||n.status===FINISH_STATE&&r!==Z_FINISH$2)return err(e,e.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(n.strm=e,t=n.last_flush,n.last_flush=r,n.status===INIT_STATE)if(n.wrap===2)e.adler=0,put_byte(n,31),put_byte(n,139),put_byte(n,8),n.gzhead?(put_byte(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),put_byte(n,n.gzhead.time&255),put_byte(n,n.gzhead.time>>8&255),put_byte(n,n.gzhead.time>>16&255),put_byte(n,n.gzhead.time>>24&255),put_byte(n,n.level===9?2:n.strategy>=Z_HUFFMAN_ONLY||n.level<2?4:0),put_byte(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(put_byte(n,n.gzhead.extra.length&255),put_byte(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=crc32$2(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=EXTRA_STATE):(put_byte(n,0),put_byte(n,0),put_byte(n,0),put_byte(n,0),put_byte(n,0),put_byte(n,n.level===9?2:n.strategy>=Z_HUFFMAN_ONLY||n.level<2?4:0),put_byte(n,OS_CODE),n.status=BUSY_STATE);else{var u=Z_DEFLATED$2+(n.w_bits-8<<4)<<8,o=-1;n.strategy>=Z_HUFFMAN_ONLY||n.level<2?o=0:n.level<6?o=1:n.level===6?o=2:o=3,u|=o<<6,n.strstart!==0&&(u|=PRESET_DICT),u+=31-u%31,n.status=BUSY_STATE,putShortMSB(n,u),n.strstart!==0&&(putShortMSB(n,e.adler>>>16),putShortMSB(n,e.adler&65535)),e.adler=1}if(n.status===EXTRA_STATE)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&!(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=crc32$2(e.adler,n.pending_buf,n.pending-s,s)),flush_pending(e),s=n.pending,n.pending===n.pending_buf_size));)put_byte(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(e.adler=crc32$2(e.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=NAME_STATE)}else n.status=NAME_STATE;if(n.status===NAME_STATE)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=crc32$2(e.adler,n.pending_buf,n.pending-s,s)),flush_pending(e),s=n.pending,n.pending===n.pending_buf_size)){l=1;break}n.gzindex<n.gzhead.name.length?l=n.gzhead.name.charCodeAt(n.gzindex++)&255:l=0,put_byte(n,l)}while(l!==0);n.gzhead.hcrc&&n.pending>s&&(e.adler=crc32$2(e.adler,n.pending_buf,n.pending-s,s)),l===0&&(n.gzindex=0,n.status=COMMENT_STATE)}else n.status=COMMENT_STATE;if(n.status===COMMENT_STATE)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=crc32$2(e.adler,n.pending_buf,n.pending-s,s)),flush_pending(e),s=n.pending,n.pending===n.pending_buf_size)){l=1;break}n.gzindex<n.gzhead.comment.length?l=n.gzhead.comment.charCodeAt(n.gzindex++)&255:l=0,put_byte(n,l)}while(l!==0);n.gzhead.hcrc&&n.pending>s&&(e.adler=crc32$2(e.adler,n.pending_buf,n.pending-s,s)),l===0&&(n.status=HCRC_STATE)}else n.status=HCRC_STATE;if(n.status===HCRC_STATE&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&flush_pending(e),n.pending+2<=n.pending_buf_size&&(put_byte(n,e.adler&255),put_byte(n,e.adler>>8&255),e.adler=0,n.status=BUSY_STATE)):n.status=BUSY_STATE),n.pending!==0){if(flush_pending(e),e.avail_out===0)return n.last_flush=-1,Z_OK$2}else if(e.avail_in===0&&rank(r)<=rank(t)&&r!==Z_FINISH$2)return err(e,Z_BUF_ERROR$1);if(n.status===FINISH_STATE&&e.avail_in!==0)return err(e,Z_BUF_ERROR$1);if(e.avail_in!==0||n.lookahead!==0||r!==Z_NO_FLUSH$1&&n.status!==FINISH_STATE){var m=n.strategy===Z_HUFFMAN_ONLY?deflate_huff(n,r):n.strategy===Z_RLE?deflate_rle(n,r):configuration_table[n.level].func(n,r);if((m===BS_FINISH_STARTED||m===BS_FINISH_DONE)&&(n.status=FINISH_STATE),m===BS_NEED_MORE||m===BS_FINISH_STARTED)return e.avail_out===0&&(n.last_flush=-1),Z_OK$2;if(m===BS_BLOCK_DONE&&(r===Z_PARTIAL_FLUSH?trees._tr_align(n):r!==Z_BLOCK$1&&(trees._tr_stored_block(n,0,0,!1),r===Z_FULL_FLUSH&&(zero(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),flush_pending(e),e.avail_out===0))return n.last_flush=-1,Z_OK$2}return r!==Z_FINISH$2?Z_OK$2:n.wrap<=0?Z_STREAM_END$2:(n.wrap===2?(put_byte(n,e.adler&255),put_byte(n,e.adler>>8&255),put_byte(n,e.adler>>16&255),put_byte(n,e.adler>>24&255),put_byte(n,e.total_in&255),put_byte(n,e.total_in>>8&255),put_byte(n,e.total_in>>16&255),put_byte(n,e.total_in>>24&255)):(putShortMSB(n,e.adler>>>16),putShortMSB(n,e.adler&65535)),flush_pending(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(e){var r;return!e||!e.state?Z_STREAM_ERROR$1:(r=e.state.status,r!==INIT_STATE&&r!==EXTRA_STATE&&r!==NAME_STATE&&r!==COMMENT_STATE&&r!==HCRC_STATE&&r!==BUSY_STATE&&r!==FINISH_STATE?err(e,Z_STREAM_ERROR$1):(e.state=null,r===BUSY_STATE?err(e,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(e,r){var t=r.length,n,s,l,u,o,m,_,p;if(!e||!e.state||(n=e.state,u=n.wrap,u===2||u===1&&n.status!==INIT_STATE||n.lookahead))return Z_STREAM_ERROR$1;for(u===1&&(e.adler=adler32$1(e.adler,r,t,0)),n.wrap=0,t>=n.w_size&&(u===0&&(zero(n.head),n.strstart=0,n.block_start=0,n.insert=0),p=new utils$i.Buf8(n.w_size),utils$i.arraySet(p,r,t-n.w_size,n.w_size,0),r=p,t=n.w_size),o=e.avail_in,m=e.next_in,_=e.input,e.avail_in=t,e.next_in=0,e.input=r,fill_window(n);n.lookahead>=MIN_MATCH;){s=n.strstart,l=n.lookahead-(MIN_MATCH-1);do n.ins_h=(n.ins_h<<n.hash_shift^n.window[s+MIN_MATCH-1])&n.hash_mask,n.prev[s&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=s,s++;while(--l);n.strstart=s,n.lookahead=MIN_MATCH-1,fill_window(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=MIN_MATCH-1,n.match_available=0,e.next_in=m,e.input=_,e.avail_in=o,n.wrap=u,Z_OK$2}deflate$3.deflateInit=deflateInit,deflate$3.deflateInit2=deflateInit2,deflate$3.deflateReset=deflateReset,deflate$3.deflateResetKeep=deflateResetKeep,deflate$3.deflateSetHeader=deflateSetHeader,deflate$3.deflate=deflate$2,deflate$3.deflateEnd=deflateEnd,deflate$3.deflateSetDictionary=deflateSetDictionary,deflate$3.deflateInfo="pako deflate (from Nodeca project)";var strings$2={},utils$h=common,STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(e){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils$h.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1,strings$2.string2buf=function(e){var r,t,n,s,l,u=e.length,o=0;for(s=0;s<u;s++)t=e.charCodeAt(s),(t&64512)===55296&&s+1<u&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(r=new utils$h.Buf8(o),l=0,s=0;l<o;s++)t=e.charCodeAt(s),(t&64512)===55296&&s+1<u&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),t<128?r[l++]=t:t<2048?(r[l++]=192|t>>>6,r[l++]=128|t&63):t<65536?(r[l++]=224|t>>>12,r[l++]=128|t>>>6&63,r[l++]=128|t&63):(r[l++]=240|t>>>18,r[l++]=128|t>>>12&63,r[l++]=128|t>>>6&63,r[l++]=128|t&63);return r};function buf2binstring(e,r){if(r<65534&&(e.subarray&&STR_APPLY_UIA_OK||!e.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$h.shrinkBuf(e,r));for(var t="",n=0;n<r;n++)t+=String.fromCharCode(e[n]);return t}strings$2.buf2binstring=function(e){return buf2binstring(e,e.length)},strings$2.binstring2buf=function(e){for(var r=new utils$h.Buf8(e.length),t=0,n=r.length;t<n;t++)r[t]=e.charCodeAt(t);return r},strings$2.buf2string=function(e,r){var t,n,s,l,u=r||e.length,o=new Array(u*2);for(n=0,t=0;t<u;){if(s=e[t++],s<128){o[n++]=s;continue}if(l=_utf8len[s],l>4){o[n++]=65533,t+=l-1;continue}for(s&=l===2?31:l===3?15:7;l>1&&t<u;)s=s<<6|e[t++]&63,l--;if(l>1){o[n++]=65533;continue}s<65536?o[n++]=s:(s-=65536,o[n++]=55296|s>>10&1023,o[n++]=56320|s&1023)}return buf2binstring(o,n)},strings$2.utf8border=function(e,r){var t;for(r=r||e.length,r>e.length&&(r=e.length),t=r-1;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+_utf8len[e[t]]>r?t:r};function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream$2,zlib_deflate=deflate$3,utils$g=common,strings$1=strings$2,msg$1=messages,ZStream$1=zstream,toString$1=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(e){if(!(this instanceof Deflate))return new Deflate(e);this.options=utils$g.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},e||{});var r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var t=zlib_deflate.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(t!==Z_OK$1)throw new Error(msg$1[t]);if(r.header&&zlib_deflate.deflateSetHeader(this.strm,r.header),r.dictionary){var n;if(typeof r.dictionary=="string"?n=strings$1.string2buf(r.dictionary):toString$1.call(r.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(r.dictionary):n=r.dictionary,t=zlib_deflate.deflateSetDictionary(this.strm,n),t!==Z_OK$1)throw new Error(msg$1[t]);this._dict_set=!0}}Deflate.prototype.push=function(e,r){var t=this.strm,n=this.options.chunkSize,s,l;if(this.ended)return!1;l=r===~~r?r:r===!0?Z_FINISH$1:Z_NO_FLUSH,typeof e=="string"?t.input=strings$1.string2buf(e):toString$1.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new utils$g.Buf8(n),t.next_out=0,t.avail_out=n),s=zlib_deflate.deflate(t,l),s!==Z_STREAM_END$1&&s!==Z_OK$1)return this.onEnd(s),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(l===Z_FINISH$1||l===Z_SYNC_FLUSH))&&(this.options.to==="string"?this.onData(strings$1.buf2binstring(utils$g.shrinkBuf(t.output,t.next_out))):this.onData(utils$g.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&s!==Z_STREAM_END$1);return l===Z_FINISH$1?(s=zlib_deflate.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Z_OK$1):(l===Z_SYNC_FLUSH&&(this.onEnd(Z_OK$1),t.avail_out=0),!0)},Deflate.prototype.onData=function(e){this.chunks.push(e)},Deflate.prototype.onEnd=function(e){e===Z_OK$1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$g.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function deflate$1(e,r){var t=new Deflate(r);if(t.push(e,!0),t.err)throw t.msg||msg$1[t.err];return t.result}function deflateRaw(e,r){return r=r||{},r.raw=!0,deflate$1(e,r)}function gzip(e,r){return r=r||{},r.gzip=!0,deflate$1(e,r)}deflate$4.Deflate=Deflate,deflate$4.deflate=deflate$1,deflate$4.deflateRaw=deflateRaw,deflate$4.gzip=gzip;var inflate$4={},inflate$3={},BAD$1=30,TYPE$1=12,inffast=function(r,t){var n,s,l,u,o,m,_,p,A,v,w,T,I,N,k,D,B,R,O,P,L,M,y,U,F;n=r.state,s=r.next_in,U=r.input,l=s+(r.avail_in-5),u=r.next_out,F=r.output,o=u-(t-r.avail_out),m=u+(r.avail_out-257),_=n.dmax,p=n.wsize,A=n.whave,v=n.wnext,w=n.window,T=n.hold,I=n.bits,N=n.lencode,k=n.distcode,D=(1<<n.lenbits)-1,B=(1<<n.distbits)-1;e:do{I<15&&(T+=U[s++]<<I,I+=8,T+=U[s++]<<I,I+=8),R=N[T&D];t:for(;;){if(O=R>>>24,T>>>=O,I-=O,O=R>>>16&255,O===0)F[u++]=R&65535;else if(O&16){P=R&65535,O&=15,O&&(I<O&&(T+=U[s++]<<I,I+=8),P+=T&(1<<O)-1,T>>>=O,I-=O),I<15&&(T+=U[s++]<<I,I+=8,T+=U[s++]<<I,I+=8),R=k[T&B];r:for(;;){if(O=R>>>24,T>>>=O,I-=O,O=R>>>16&255,O&16){if(L=R&65535,O&=15,I<O&&(T+=U[s++]<<I,I+=8,I<O&&(T+=U[s++]<<I,I+=8)),L+=T&(1<<O)-1,L>_){r.msg="invalid distance too far back",n.mode=BAD$1;break e}if(T>>>=O,I-=O,O=u-o,L>O){if(O=L-O,O>A&&n.sane){r.msg="invalid distance too far back",n.mode=BAD$1;break e}if(M=0,y=w,v===0){if(M+=p-O,O<P){P-=O;do F[u++]=w[M++];while(--O);M=u-L,y=F}}else if(v<O){if(M+=p+v-O,O-=v,O<P){P-=O;do F[u++]=w[M++];while(--O);if(M=0,v<P){O=v,P-=O;do F[u++]=w[M++];while(--O);M=u-L,y=F}}}else if(M+=v-O,O<P){P-=O;do F[u++]=w[M++];while(--O);M=u-L,y=F}for(;P>2;)F[u++]=y[M++],F[u++]=y[M++],F[u++]=y[M++],P-=3;P&&(F[u++]=y[M++],P>1&&(F[u++]=y[M++]))}else{M=u-L;do F[u++]=F[M++],F[u++]=F[M++],F[u++]=F[M++],P-=3;while(P>2);P&&(F[u++]=F[M++],P>1&&(F[u++]=F[M++]))}}else if((O&64)===0){R=k[(R&65535)+(T&(1<<O)-1)];continue r}else{r.msg="invalid distance code",n.mode=BAD$1;break e}break}}else if((O&64)===0){R=N[(R&65535)+(T&(1<<O)-1)];continue t}else if(O&32){n.mode=TYPE$1;break e}else{r.msg="invalid literal/length code",n.mode=BAD$1;break e}break}}while(s<l&&u<m);P=I>>3,s-=P,I-=P<<3,T&=(1<<I)-1,r.next_in=s,r.next_out=u,r.avail_in=s<l?5+(l-s):5-(s-l),r.avail_out=u<m?257+(m-u):257-(u-m),n.hold=T,n.bits=I},utils$f=common,MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(r,t,n,s,l,u,o,m){var _=m.bits,p=0,A=0,v=0,w=0,T=0,I=0,N=0,k=0,D=0,B=0,R,O,P,L,M,y=null,U=0,F,Z=new utils$f.Buf16(MAXBITS+1),te=new utils$f.Buf16(MAXBITS+1),ie=null,ne=0,fe,H,se;for(p=0;p<=MAXBITS;p++)Z[p]=0;for(A=0;A<s;A++)Z[t[n+A]]++;for(T=_,w=MAXBITS;w>=1&&Z[w]===0;w--);if(T>w&&(T=w),w===0)return l[u++]=1<<24|64<<16|0,l[u++]=1<<24|64<<16|0,m.bits=1,0;for(v=1;v<w&&Z[v]===0;v++);for(T<v&&(T=v),k=1,p=1;p<=MAXBITS;p++)if(k<<=1,k-=Z[p],k<0)return-1;if(k>0&&(r===CODES$1||w!==1))return-1;for(te[1]=0,p=1;p<MAXBITS;p++)te[p+1]=te[p]+Z[p];for(A=0;A<s;A++)t[n+A]!==0&&(o[te[t[n+A]]++]=A);if(r===CODES$1?(y=ie=o,F=19):r===LENS$1?(y=lbase,U-=257,ie=lext,ne-=257,F=256):(y=dbase,ie=dext,F=-1),B=0,A=0,p=v,M=u,I=T,N=0,P=-1,D=1<<T,L=D-1,r===LENS$1&&D>ENOUGH_LENS$1||r===DISTS$1&&D>ENOUGH_DISTS$1)return 1;for(;;){fe=p-N,o[A]<F?(H=0,se=o[A]):o[A]>F?(H=ie[ne+o[A]],se=y[U+o[A]]):(H=32+64,se=0),R=1<<p-N,O=1<<I,v=O;do O-=R,l[M+(B>>N)+O]=fe<<24|H<<16|se|0;while(O!==0);for(R=1<<p-1;B&R;)R>>=1;if(R!==0?(B&=R-1,B+=R):B=0,A++,--Z[p]===0){if(p===w)break;p=t[n+o[A]]}if(p>T&&(B&L)!==P){for(N===0&&(N=T),M+=v,I=p-N,k=1<<I;I+N<w&&(k-=Z[I+N],!(k<=0));)I++,k<<=1;if(D+=1<<I,r===LENS$1&&D>ENOUGH_LENS$1||r===DISTS$1&&D>ENOUGH_DISTS$1)return 1;P=B&L,l[P]=T<<24|I<<16|M-u|0}}return B!==0&&(l[M+B]=p-N<<24|64<<16|0),m.bits=T,0},utils$e=common,adler32=adler32_1,crc32$1=crc32_1,inflate_fast=inffast,inflate_table=inftrees,CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$e.Buf16(320),this.work=new utils$e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(e){var r;return!e||!e.state?Z_STREAM_ERROR:(r=e.state,e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=HEAD,r.last=0,r.havedict=0,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new utils$e.Buf32(ENOUGH_LENS),r.distcode=r.distdyn=new utils$e.Buf32(ENOUGH_DISTS),r.sane=1,r.back=-1,Z_OK)}function inflateReset(e){var r;return!e||!e.state?Z_STREAM_ERROR:(r=e.state,r.wsize=0,r.whave=0,r.wnext=0,inflateResetKeep(e))}function inflateReset2(e,r){var t,n;return!e||!e.state||(n=e.state,r<0?(t=0,r=-r):(t=(r>>4)+1,r<48&&(r&=15)),r&&(r<8||r>15))?Z_STREAM_ERROR:(n.window!==null&&n.wbits!==r&&(n.window=null),n.wrap=t,n.wbits=r,inflateReset(e))}function inflateInit2(e,r){var t,n;return e?(n=new InflateState,e.state=n,n.window=null,t=inflateReset2(e,r),t!==Z_OK&&(e.state=null),t):Z_STREAM_ERROR}function inflateInit(e){return inflateInit2(e,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(e){if(virgin){var r;for(lenfix=new utils$e.Buf32(512),distfix=new utils$e.Buf32(32),r=0;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(inflate_table(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;inflate_table(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5}function updatewindow(e,r,t,n){var s,l=e.state;return l.window===null&&(l.wsize=1<<l.wbits,l.wnext=0,l.whave=0,l.window=new utils$e.Buf8(l.wsize)),n>=l.wsize?(utils$e.arraySet(l.window,r,t-l.wsize,l.wsize,0),l.wnext=0,l.whave=l.wsize):(s=l.wsize-l.wnext,s>n&&(s=n),utils$e.arraySet(l.window,r,t-n,s,l.wnext),n-=s,n?(utils$e.arraySet(l.window,r,t-n,n,0),l.wnext=n,l.whave=l.wsize):(l.wnext+=s,l.wnext===l.wsize&&(l.wnext=0),l.whave<l.wsize&&(l.whave+=s))),0}function inflate$2(e,r){var t,n,s,l,u,o,m,_,p,A,v,w,T,I,N=0,k,D,B,R,O,P,L,M,y=new utils$e.Buf8(4),U,F,Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Z_STREAM_ERROR;t=e.state,t.mode===TYPE&&(t.mode=TYPEDO),u=e.next_out,s=e.output,m=e.avail_out,l=e.next_in,n=e.input,o=e.avail_in,_=t.hold,p=t.bits,A=o,v=m,M=Z_OK;e:for(;;)switch(t.mode){case HEAD:if(t.wrap===0){t.mode=TYPEDO;break}for(;p<16;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if(t.wrap&2&&_===35615){t.check=0,y[0]=_&255,y[1]=_>>>8&255,t.check=crc32$1(t.check,y,2,0),_=0,p=0,t.mode=FLAGS;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((_&255)<<8)+(_>>8))%31){e.msg="incorrect header check",t.mode=BAD;break}if((_&15)!==Z_DEFLATED){e.msg="unknown compression method",t.mode=BAD;break}if(_>>>=4,p-=4,L=(_&15)+8,t.wbits===0)t.wbits=L;else if(L>t.wbits){e.msg="invalid window size",t.mode=BAD;break}t.dmax=1<<L,e.adler=t.check=1,t.mode=_&512?DICTID:TYPE,_=0,p=0;break;case FLAGS:for(;p<16;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if(t.flags=_,(t.flags&255)!==Z_DEFLATED){e.msg="unknown compression method",t.mode=BAD;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=BAD;break}t.head&&(t.head.text=_>>8&1),t.flags&512&&(y[0]=_&255,y[1]=_>>>8&255,t.check=crc32$1(t.check,y,2,0)),_=0,p=0,t.mode=TIME;case TIME:for(;p<32;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}t.head&&(t.head.time=_),t.flags&512&&(y[0]=_&255,y[1]=_>>>8&255,y[2]=_>>>16&255,y[3]=_>>>24&255,t.check=crc32$1(t.check,y,4,0)),_=0,p=0,t.mode=OS;case OS:for(;p<16;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}t.head&&(t.head.xflags=_&255,t.head.os=_>>8),t.flags&512&&(y[0]=_&255,y[1]=_>>>8&255,t.check=crc32$1(t.check,y,2,0)),_=0,p=0,t.mode=EXLEN;case EXLEN:if(t.flags&1024){for(;p<16;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}t.length=_,t.head&&(t.head.extra_len=_),t.flags&512&&(y[0]=_&255,y[1]=_>>>8&255,t.check=crc32$1(t.check,y,2,0)),_=0,p=0}else t.head&&(t.head.extra=null);t.mode=EXTRA;case EXTRA:if(t.flags&1024&&(w=t.length,w>o&&(w=o),w&&(t.head&&(L=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),utils$e.arraySet(t.head.extra,n,l,w,L)),t.flags&512&&(t.check=crc32$1(t.check,n,w,l)),o-=w,l+=w,t.length-=w),t.length))break e;t.length=0,t.mode=NAME;case NAME:if(t.flags&2048){if(o===0)break e;w=0;do L=n[l+w++],t.head&&L&&t.length<65536&&(t.head.name+=String.fromCharCode(L));while(L&&w<o);if(t.flags&512&&(t.check=crc32$1(t.check,n,w,l)),o-=w,l+=w,L)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=COMMENT;case COMMENT:if(t.flags&4096){if(o===0)break e;w=0;do L=n[l+w++],t.head&&L&&t.length<65536&&(t.head.comment+=String.fromCharCode(L));while(L&&w<o);if(t.flags&512&&(t.check=crc32$1(t.check,n,w,l)),o-=w,l+=w,L)break e}else t.head&&(t.head.comment=null);t.mode=HCRC;case HCRC:if(t.flags&512){for(;p<16;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if(_!==(t.check&65535)){e.msg="header crc mismatch",t.mode=BAD;break}_=0,p=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=TYPE;break;case DICTID:for(;p<32;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}e.adler=t.check=zswap32(_),_=0,p=0,t.mode=DICT;case DICT:if(t.havedict===0)return e.next_out=u,e.avail_out=m,e.next_in=l,e.avail_in=o,t.hold=_,t.bits=p,Z_NEED_DICT;e.adler=t.check=1,t.mode=TYPE;case TYPE:if(r===Z_BLOCK||r===Z_TREES)break e;case TYPEDO:if(t.last){_>>>=p&7,p-=p&7,t.mode=CHECK;break}for(;p<3;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}switch(t.last=_&1,_>>>=1,p-=1,_&3){case 0:t.mode=STORED;break;case 1:if(fixedtables(t),t.mode=LEN_,r===Z_TREES){_>>>=2,p-=2;break e}break;case 2:t.mode=TABLE;break;case 3:e.msg="invalid block type",t.mode=BAD}_>>>=2,p-=2;break;case STORED:for(_>>>=p&7,p-=p&7;p<32;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if((_&65535)!==(_>>>16^65535)){e.msg="invalid stored block lengths",t.mode=BAD;break}if(t.length=_&65535,_=0,p=0,t.mode=COPY_,r===Z_TREES)break e;case COPY_:t.mode=COPY;case COPY:if(w=t.length,w){if(w>o&&(w=o),w>m&&(w=m),w===0)break e;utils$e.arraySet(s,n,l,w,u),o-=w,l+=w,m-=w,u+=w,t.length-=w;break}t.mode=TYPE;break;case TABLE:for(;p<14;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if(t.nlen=(_&31)+257,_>>>=5,p-=5,t.ndist=(_&31)+1,_>>>=5,p-=5,t.ncode=(_&15)+4,_>>>=4,p-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=BAD;break}t.have=0,t.mode=LENLENS;case LENLENS:for(;t.have<t.ncode;){for(;p<3;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}t.lens[Z[t.have++]]=_&7,_>>>=3,p-=3}for(;t.have<19;)t.lens[Z[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,U={bits:t.lenbits},M=inflate_table(CODES,t.lens,0,19,t.lencode,0,t.work,U),t.lenbits=U.bits,M){e.msg="invalid code lengths set",t.mode=BAD;break}t.have=0,t.mode=CODELENS;case CODELENS:for(;t.have<t.nlen+t.ndist;){for(;N=t.lencode[_&(1<<t.lenbits)-1],k=N>>>24,D=N>>>16&255,B=N&65535,!(k<=p);){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if(B<16)_>>>=k,p-=k,t.lens[t.have++]=B;else{if(B===16){for(F=k+2;p<F;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if(_>>>=k,p-=k,t.have===0){e.msg="invalid bit length repeat",t.mode=BAD;break}L=t.lens[t.have-1],w=3+(_&3),_>>>=2,p-=2}else if(B===17){for(F=k+3;p<F;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}_>>>=k,p-=k,L=0,w=3+(_&7),_>>>=3,p-=3}else{for(F=k+7;p<F;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}_>>>=k,p-=k,L=0,w=11+(_&127),_>>>=7,p-=7}if(t.have+w>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=BAD;break}for(;w--;)t.lens[t.have++]=L}}if(t.mode===BAD)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=BAD;break}if(t.lenbits=9,U={bits:t.lenbits},M=inflate_table(LENS,t.lens,0,t.nlen,t.lencode,0,t.work,U),t.lenbits=U.bits,M){e.msg="invalid literal/lengths set",t.mode=BAD;break}if(t.distbits=6,t.distcode=t.distdyn,U={bits:t.distbits},M=inflate_table(DISTS,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,U),t.distbits=U.bits,M){e.msg="invalid distances set",t.mode=BAD;break}if(t.mode=LEN_,r===Z_TREES)break e;case LEN_:t.mode=LEN;case LEN:if(o>=6&&m>=258){e.next_out=u,e.avail_out=m,e.next_in=l,e.avail_in=o,t.hold=_,t.bits=p,inflate_fast(e,v),u=e.next_out,s=e.output,m=e.avail_out,l=e.next_in,n=e.input,o=e.avail_in,_=t.hold,p=t.bits,t.mode===TYPE&&(t.back=-1);break}for(t.back=0;N=t.lencode[_&(1<<t.lenbits)-1],k=N>>>24,D=N>>>16&255,B=N&65535,!(k<=p);){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if(D&&(D&240)===0){for(R=k,O=D,P=B;N=t.lencode[P+((_&(1<<R+O)-1)>>R)],k=N>>>24,D=N>>>16&255,B=N&65535,!(R+k<=p);){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}_>>>=R,p-=R,t.back+=R}if(_>>>=k,p-=k,t.back+=k,t.length=B,D===0){t.mode=LIT;break}if(D&32){t.back=-1,t.mode=TYPE;break}if(D&64){e.msg="invalid literal/length code",t.mode=BAD;break}t.extra=D&15,t.mode=LENEXT;case LENEXT:if(t.extra){for(F=t.extra;p<F;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}t.length+=_&(1<<t.extra)-1,_>>>=t.extra,p-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=DIST;case DIST:for(;N=t.distcode[_&(1<<t.distbits)-1],k=N>>>24,D=N>>>16&255,B=N&65535,!(k<=p);){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if((D&240)===0){for(R=k,O=D,P=B;N=t.distcode[P+((_&(1<<R+O)-1)>>R)],k=N>>>24,D=N>>>16&255,B=N&65535,!(R+k<=p);){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}_>>>=R,p-=R,t.back+=R}if(_>>>=k,p-=k,t.back+=k,D&64){e.msg="invalid distance code",t.mode=BAD;break}t.offset=B,t.extra=D&15,t.mode=DISTEXT;case DISTEXT:if(t.extra){for(F=t.extra;p<F;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}t.offset+=_&(1<<t.extra)-1,_>>>=t.extra,p-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=BAD;break}t.mode=MATCH;case MATCH:if(m===0)break e;if(w=v-m,t.offset>w){if(w=t.offset-w,w>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=BAD;break}w>t.wnext?(w-=t.wnext,T=t.wsize-w):T=t.wnext-w,w>t.length&&(w=t.length),I=t.window}else I=s,T=u-t.offset,w=t.length;w>m&&(w=m),m-=w,t.length-=w;do s[u++]=I[T++];while(--w);t.length===0&&(t.mode=LEN);break;case LIT:if(m===0)break e;s[u++]=t.length,m--,t.mode=LEN;break;case CHECK:if(t.wrap){for(;p<32;){if(o===0)break e;o--,_|=n[l++]<<p,p+=8}if(v-=m,e.total_out+=v,t.total+=v,v&&(e.adler=t.check=t.flags?crc32$1(t.check,s,v,u-v):adler32(t.check,s,v,u-v)),v=m,(t.flags?_:zswap32(_))!==t.check){e.msg="incorrect data check",t.mode=BAD;break}_=0,p=0}t.mode=LENGTH;case LENGTH:if(t.wrap&&t.flags){for(;p<32;){if(o===0)break e;o--,_+=n[l++]<<p,p+=8}if(_!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=BAD;break}_=0,p=0}t.mode=DONE;case DONE:M=Z_STREAM_END;break e;case BAD:M=Z_DATA_ERROR;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return e.next_out=u,e.avail_out=m,e.next_in=l,e.avail_in=o,t.hold=_,t.bits=p,(t.wsize||v!==e.avail_out&&t.mode<BAD&&(t.mode<CHECK||r!==Z_FINISH))&&updatewindow(e,e.output,e.next_out,v-e.avail_out),A-=e.avail_in,v-=e.avail_out,e.total_in+=A,e.total_out+=v,t.total+=v,t.wrap&&v&&(e.adler=t.check=t.flags?crc32$1(t.check,s,v,e.next_out-v):adler32(t.check,s,v,e.next_out-v)),e.data_type=t.bits+(t.last?64:0)+(t.mode===TYPE?128:0)+(t.mode===LEN_||t.mode===COPY_?256:0),(A===0&&v===0||r===Z_FINISH)&&M===Z_OK&&(M=Z_BUF_ERROR),M}function inflateEnd(e){if(!e||!e.state)return Z_STREAM_ERROR;var r=e.state;return r.window&&(r.window=null),e.state=null,Z_OK}function inflateGetHeader(e,r){var t;return!e||!e.state||(t=e.state,(t.wrap&2)===0)?Z_STREAM_ERROR:(t.head=r,r.done=!1,Z_OK)}function inflateSetDictionary(e,r){var t=r.length,n,s,l;return!e||!e.state||(n=e.state,n.wrap!==0&&n.mode!==DICT)?Z_STREAM_ERROR:n.mode===DICT&&(s=1,s=adler32(s,r,t,0),s!==n.check)?Z_DATA_ERROR:(l=updatewindow(e,r,t,t),l?(n.mode=MEM,Z_MEM_ERROR):(n.havedict=1,Z_OK))}inflate$3.inflateReset=inflateReset,inflate$3.inflateReset2=inflateReset2,inflate$3.inflateResetKeep=inflateResetKeep,inflate$3.inflateInit=inflateInit,inflate$3.inflateInit2=inflateInit2,inflate$3.inflate=inflate$2,inflate$3.inflateEnd=inflateEnd,inflate$3.inflateGetHeader=inflateGetHeader,inflate$3.inflateSetDictionary=inflateSetDictionary,inflate$3.inflateInfo="pako inflate (from Nodeca project)";var constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader$1,zlib_inflate=inflate$3,utils$d=common,strings=strings$2,c=constants$1,msg=messages,ZStream=zstream,GZheader=gzheader,toString=Object.prototype.toString;function Inflate(e){if(!(this instanceof Inflate))return new Inflate(e);this.options=utils$d.assign({chunkSize:16384,windowBits:0,to:""},e||{});var r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var t=zlib_inflate.inflateInit2(this.strm,r.windowBits);if(t!==c.Z_OK)throw new Error(msg[t]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=strings.string2buf(r.dictionary):toString.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(t=zlib_inflate.inflateSetDictionary(this.strm,r.dictionary),t!==c.Z_OK)))throw new Error(msg[t])}Inflate.prototype.push=function(e,r){var t=this.strm,n=this.options.chunkSize,s=this.options.dictionary,l,u,o,m,_,p=!1;if(this.ended)return!1;u=r===~~r?r:r===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof e=="string"?t.input=strings.binstring2buf(e):toString.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new utils$d.Buf8(n),t.next_out=0,t.avail_out=n),l=zlib_inflate.inflate(t,c.Z_NO_FLUSH),l===c.Z_NEED_DICT&&s&&(l=zlib_inflate.inflateSetDictionary(this.strm,s)),l===c.Z_BUF_ERROR&&p===!0&&(l=c.Z_OK,p=!1),l!==c.Z_STREAM_END&&l!==c.Z_OK)return this.onEnd(l),this.ended=!0,!1;t.next_out&&(t.avail_out===0||l===c.Z_STREAM_END||t.avail_in===0&&(u===c.Z_FINISH||u===c.Z_SYNC_FLUSH))&&(this.options.to==="string"?(o=strings.utf8border(t.output,t.next_out),m=t.next_out-o,_=strings.buf2string(t.output,o),t.next_out=m,t.avail_out=n-m,m&&utils$d.arraySet(t.output,t.output,o,m,0),this.onData(_)):this.onData(utils$d.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(p=!0)}while((t.avail_in>0||t.avail_out===0)&&l!==c.Z_STREAM_END);return l===c.Z_STREAM_END&&(u=c.Z_FINISH),u===c.Z_FINISH?(l=zlib_inflate.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===c.Z_OK):(u===c.Z_SYNC_FLUSH&&(this.onEnd(c.Z_OK),t.avail_out=0),!0)},Inflate.prototype.onData=function(e){this.chunks.push(e)},Inflate.prototype.onEnd=function(e){e===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$d.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function inflate$1(e,r){var t=new Inflate(r);if(t.push(e,!0),t.err)throw t.msg||msg[t.err];return t.result}function inflateRaw(e,r){return r=r||{},r.raw=!0,inflate$1(e,r)}inflate$4.Inflate=Inflate,inflate$4.inflate=inflate$1,inflate$4.inflateRaw=inflateRaw,inflate$4.ungzip=inflate$1;var assign=common.assign,deflate=deflate$4,inflate=inflate$4,constants=constants$1,pako$1={};assign(pako$1,deflate,inflate,constants);var pako_1=pako$1,USE_TYPEDARRAY=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",pako=pako_1,utils$c=utils$r,GenericWorker$4=GenericWorker_1,ARRAY_TYPE=USE_TYPEDARRAY?"uint8array":"array";flate.magic="\b\0";function FlateWorker(e,r){GenericWorker$4.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=r,this.meta={}}utils$c.inherits(FlateWorker,GenericWorker$4),FlateWorker.prototype.processChunk=function(e){this.meta=e.meta,this._pako===null&&this._createPako(),this._pako.push(utils$c.transformTo(ARRAY_TYPE,e.data),!1)},FlateWorker.prototype.flush=function(){GenericWorker$4.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){GenericWorker$4.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new pako[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(r){e.push({data:r,meta:e.meta})}},flate.compressWorker=function(e){return new FlateWorker("Deflate",e)},flate.uncompressWorker=function(){return new FlateWorker("Inflate",{})};var GenericWorker$3=GenericWorker_1;compressions$2.STORE={magic:"\0\0",compressWorker:function(){return new GenericWorker$3("STORE compression")},uncompressWorker:function(){return new GenericWorker$3("STORE decompression")}},compressions$2.DEFLATE=flate;var signature$1={};signature$1.LOCAL_FILE_HEADER="PK",signature$1.CENTRAL_FILE_HEADER="PK",signature$1.CENTRAL_DIRECTORY_END="PK",signature$1.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",signature$1.ZIP64_CENTRAL_DIRECTORY_END="PK",signature$1.DATA_DESCRIPTOR="PK\x07\b";var utils$b=utils$r,GenericWorker$2=GenericWorker_1,utf8$3=utf8$5,crc32=crc32_1$1,signature=signature$1,decToHex=function(e,r){var t="",n;for(n=0;n<r;n++)t+=String.fromCharCode(e&255),e=e>>>8;return t},generateUnixExternalFileAttr=function(e,r){var t=e;return e||(t=r?16893:33204),(t&65535)<<16},generateDosExternalFileAttr=function(e){return(e||0)&63},generateZipParts=function(e,r,t,n,s,l){var u=e.file,o=e.compression,m=l!==utf8$3.utf8encode,_=utils$b.transformTo("string",l(u.name)),p=utils$b.transformTo("string",utf8$3.utf8encode(u.name)),A=u.comment,v=utils$b.transformTo("string",l(A)),w=utils$b.transformTo("string",utf8$3.utf8encode(A)),T=p.length!==u.name.length,I=w.length!==A.length,N,k,D="",B="",R="",O=u.dir,P=u.date,L={crc32:0,compressedSize:0,uncompressedSize:0};(!r||t)&&(L.crc32=e.crc32,L.compressedSize=e.compressedSize,L.uncompressedSize=e.uncompressedSize);var M=0;r&&(M|=8),!m&&(T||I)&&(M|=2048);var y=0,U=0;O&&(y|=16),s==="UNIX"?(U=798,y|=generateUnixExternalFileAttr(u.unixPermissions,O)):(U=20,y|=generateDosExternalFileAttr(u.dosPermissions)),N=P.getUTCHours(),N=N<<6,N=N|P.getUTCMinutes(),N=N<<5,N=N|P.getUTCSeconds()/2,k=P.getUTCFullYear()-1980,k=k<<4,k=k|P.getUTCMonth()+1,k=k<<5,k=k|P.getUTCDate(),T&&(B=decToHex(1,1)+decToHex(crc32(_),4)+p,D+="up"+decToHex(B.length,2)+B),I&&(R=decToHex(1,1)+decToHex(crc32(v),4)+w,D+="uc"+decToHex(R.length,2)+R);var F="";F+=`
\0`,F+=decToHex(M,2),F+=o.magic,F+=decToHex(N,2),F+=decToHex(k,2),F+=decToHex(L.crc32,4),F+=decToHex(L.compressedSize,4),F+=decToHex(L.uncompressedSize,4),F+=decToHex(_.length,2),F+=decToHex(D.length,2);var Z=signature.LOCAL_FILE_HEADER+F+_+D,te=signature.CENTRAL_FILE_HEADER+decToHex(U,2)+F+decToHex(v.length,2)+"\0\0\0\0"+decToHex(y,4)+decToHex(n,4)+_+D+v;return{fileRecord:Z,dirRecord:te}},generateCentralDirectoryEnd=function(e,r,t,n,s){var l="",u=utils$b.transformTo("string",s(n));return l=signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(e,2)+decToHex(e,2)+decToHex(r,4)+decToHex(t,4)+decToHex(u.length,2)+u,l},generateDataDescriptors=function(e){var r="";return r=signature.DATA_DESCRIPTOR+decToHex(e.crc32,4)+decToHex(e.compressedSize,4)+decToHex(e.uncompressedSize,4),r};function ZipFileWorker$1(e,r,t,n){GenericWorker$2.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=r,this.zipPlatform=t,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}utils$b.inherits(ZipFileWorker$1,GenericWorker$2),ZipFileWorker$1.prototype.push=function(e){var r=e.meta.percent||0,t=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,GenericWorker$2.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:t?(r+100*(t-n-1))/t:100}}))},ZipFileWorker$1.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var r=this.streamFiles&&!e.file.dir;if(r){var t=generateZipParts(e,r,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:t.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker$1.prototype.closedSource=function(e){this.accumulate=!1;var r=this.streamFiles&&!e.file.dir,t=generateZipParts(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),r)this.push({data:generateDataDescriptors(e),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker$1.prototype.flush=function(){for(var e=this.bytesWritten,r=0;r<this.dirRecords.length;r++)this.push({data:this.dirRecords[r],meta:{percent:100}});var t=this.bytesWritten-e,n=generateCentralDirectoryEnd(this.dirRecords.length,t,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},ZipFileWorker$1.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker$1.prototype.registerPrevious=function(e){this._sources.push(e);var r=this;return e.on("data",function(t){r.processChunk(t)}),e.on("end",function(){r.closedSource(r.previous.streamInfo),r._sources.length?r.prepareNextSource():r.end()}),e.on("error",function(t){r.error(t)}),this},ZipFileWorker$1.prototype.resume=function(){if(!GenericWorker$2.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},ZipFileWorker$1.prototype.error=function(e){var r=this._sources;if(!GenericWorker$2.prototype.error.call(this,e))return!1;for(var t=0;t<r.length;t++)try{r[t].error(e)}catch(n){}return!0},ZipFileWorker$1.prototype.lock=function(){GenericWorker$2.prototype.lock.call(this);for(var e=this._sources,r=0;r<e.length;r++)e[r].lock()};var ZipFileWorker_1=ZipFileWorker$1,compressions$1=compressions$2,ZipFileWorker=ZipFileWorker_1,getCompression=function(e,r){var t=e||r,n=compressions$1[t];if(!n)throw new Error(t+" is not a valid compression method !");return n};generate$1.generateWorker=function(e,r,t){var n=new ZipFileWorker(r.streamFiles,t,r.platform,r.encodeFileName),s=0;try{e.forEach(function(l,u){s++;var o=getCompression(u.options.compression,r.compression),m=u.options.compressionOptions||r.compressionOptions||{},_=u.dir,p=u.date;u._compressWorker(o,m).withStreamInfo("file",{name:l,dir:_,date:p,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(n)}),n.entriesCount=s}catch(l){n.error(l)}return n};var utils$a=utils$r,GenericWorker$1=GenericWorker_1;function NodejsStreamInputAdapter$1(e,r){GenericWorker$1.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(r)}utils$a.inherits(NodejsStreamInputAdapter$1,GenericWorker$1),NodejsStreamInputAdapter$1.prototype._bindStream=function(e){var r=this;this._stream=e,e.pause(),e.on("data",function(t){r.push({data:t,meta:{percent:0}})}).on("error",function(t){r.isPaused?this.generatedError=t:r.error(t)}).on("end",function(){r.isPaused?r._upstreamEnded=!0:r.end()})},NodejsStreamInputAdapter$1.prototype.pause=function(){return GenericWorker$1.prototype.pause.call(this)?(this._stream.pause(),!0):!1},NodejsStreamInputAdapter$1.prototype.resume=function(){return GenericWorker$1.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};var NodejsStreamInputAdapter_1=NodejsStreamInputAdapter$1,utf8$2=utf8$5,utils$9=utils$r,GenericWorker=GenericWorker_1,StreamHelper=StreamHelper_1,defaults=defaults$1,CompressedObject$1=compressedObject,ZipObject=zipObject,generate=generate$1,nodejsUtils$1=nodejsUtils$2,NodejsStreamInputAdapter=NodejsStreamInputAdapter_1,fileAdd=function(e,r,t){var n=utils$9.getTypeOf(r),s,l=utils$9.extend(t||{},defaults);l.date=l.date||new Date,l.compression!==null&&(l.compression=l.compression.toUpperCase()),typeof l.unixPermissions=="string"&&(l.unixPermissions=parseInt(l.unixPermissions,8)),l.unixPermissions&&l.unixPermissions&16384&&(l.dir=!0),l.dosPermissions&&l.dosPermissions&16&&(l.dir=!0),l.dir&&(e=forceTrailingSlash(e)),l.createFolders&&(s=parentFolder(e))&&folderAdd.call(this,s,!0);var u=n==="string"&&l.binary===!1&&l.base64===!1;(!t||typeof t.binary=="undefined")&&(l.binary=!u);var o=r instanceof CompressedObject$1&&r.uncompressedSize===0;(o||l.dir||!r||r.length===0)&&(l.base64=!1,l.binary=!0,r="",l.compression="STORE",n="string");var m=null;r instanceof CompressedObject$1||r instanceof GenericWorker?m=r:nodejsUtils$1.isNode&&nodejsUtils$1.isStream(r)?m=new NodejsStreamInputAdapter(e,r):m=utils$9.prepareContent(e,r,l.binary,l.optimizedBinaryString,l.base64);var _=new ZipObject(e,m,l);this.files[e]=_},parentFolder=function(e){e.slice(-1)==="/"&&(e=e.substring(0,e.length-1));var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""},forceTrailingSlash=function(e){return e.slice(-1)!=="/"&&(e+="/"),e},folderAdd=function(e,r){return r=typeof r!="undefined"?r:defaults.createFolders,e=forceTrailingSlash(e),this.files[e]||fileAdd.call(this,e,null,{dir:!0,createFolders:r}),this.files[e]};function isRegExp(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var out={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var r,t,n;for(r in this.files)n=this.files[r],t=r.slice(this.root.length,r.length),t&&r.slice(0,this.root.length)===this.root&&e(t,n)},filter:function(e){var r=[];return this.forEach(function(t,n){e(t,n)&&r.push(n)}),r},file:function(e,r,t){if(arguments.length===1)if(isRegExp(e)){var n=e;return this.filter(function(l,u){return!u.dir&&n.test(l)})}else{var s=this.files[this.root+e];return s&&!s.dir?s:null}else e=this.root+e,fileAdd.call(this,e,r,t);return this},folder:function(e){if(!e)return this;if(isRegExp(e))return this.filter(function(s,l){return l.dir&&e.test(s)});var r=this.root+e,t=folderAdd.call(this,r),n=this.clone();return n.root=t.name,n},remove:function(e){e=this.root+e;var r=this.files[e];if(r||(e.slice(-1)!=="/"&&(e+="/"),r=this.files[e]),r&&!r.dir)delete this.files[e];else for(var t=this.filter(function(s,l){return l.name.slice(0,e.length)===e}),n=0;n<t.length;n++)delete this.files[t[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var r,t={};try{if(t=utils$9.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:utf8$2.utf8encode}),t.type=t.type.toLowerCase(),t.compression=t.compression.toUpperCase(),t.type==="binarystring"&&(t.type="string"),!t.type)throw new Error("No output type specified.");utils$9.checkSupport(t.type),(t.platform==="darwin"||t.platform==="freebsd"||t.platform==="linux"||t.platform==="sunos")&&(t.platform="UNIX"),t.platform==="win32"&&(t.platform="DOS");var n=t.comment||this.comment||"";r=generate.generateWorker(this,t,n)}catch(s){r=new GenericWorker("error"),r.error(s)}return new StreamHelper(r,t.type||"string",t.mimeType)},generateAsync:function(e,r){return this.generateInternalStream(e).accumulate(r)},generateNodeStream:function(e,r){return e=e||{},e.type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(r)}},object=out,utils$8=utils$r;function DataReader$2(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}DataReader$2.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var r=0,t;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return utils$8.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1))}};var DataReader_1=DataReader$2,DataReader$1=DataReader_1,utils$7=utils$r;function ArrayReader$2(e){DataReader$1.call(this,e);for(var r=0;r<this.data.length;r++)e[r]=e[r]&255}utils$7.inherits(ArrayReader$2,DataReader$1),ArrayReader$2.prototype.byteAt=function(e){return this.data[this.zero+e]},ArrayReader$2.prototype.lastIndexOfSignature=function(e){for(var r=e.charCodeAt(0),t=e.charCodeAt(1),n=e.charCodeAt(2),s=e.charCodeAt(3),l=this.length-4;l>=0;--l)if(this.data[l]===r&&this.data[l+1]===t&&this.data[l+2]===n&&this.data[l+3]===s)return l-this.zero;return-1},ArrayReader$2.prototype.readAndCheckSignature=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1),n=e.charCodeAt(2),s=e.charCodeAt(3),l=this.readData(4);return r===l[0]&&t===l[1]&&n===l[2]&&s===l[3]},ArrayReader$2.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var ArrayReader_1=ArrayReader$2,DataReader=DataReader_1,utils$6=utils$r;function StringReader$1(e){DataReader.call(this,e)}utils$6.inherits(StringReader$1,DataReader),StringReader$1.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},StringReader$1.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},StringReader$1.prototype.readAndCheckSignature=function(e){var r=this.readData(4);return e===r},StringReader$1.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var StringReader_1=StringReader$1,ArrayReader$1=ArrayReader_1,utils$5=utils$r;function Uint8ArrayReader$2(e){ArrayReader$1.call(this,e)}utils$5.inherits(Uint8ArrayReader$2,ArrayReader$1),Uint8ArrayReader$2.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var r=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var Uint8ArrayReader_1=Uint8ArrayReader$2,Uint8ArrayReader$1=Uint8ArrayReader_1,utils$4=utils$r;function NodeBufferReader$1(e){Uint8ArrayReader$1.call(this,e)}utils$4.inherits(NodeBufferReader$1,Uint8ArrayReader$1),NodeBufferReader$1.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var NodeBufferReader_1=NodeBufferReader$1,utils$3=utils$r,support$2=support$5,ArrayReader=ArrayReader_1,StringReader=StringReader_1,NodeBufferReader=NodeBufferReader_1,Uint8ArrayReader=Uint8ArrayReader_1,readerFor$2=function(e){var r=utils$3.getTypeOf(e);return utils$3.checkSupport(r),r==="string"&&!support$2.uint8array?new StringReader(e):r==="nodebuffer"?new NodeBufferReader(e):support$2.uint8array?new Uint8ArrayReader(utils$3.transformTo("uint8array",e)):new ArrayReader(utils$3.transformTo("array",e))},readerFor$1=readerFor$2,utils$2=utils$r,CompressedObject=compressedObject,crc32fn=crc32_1$1,utf8$1=utf8$5,compressions=compressions$2,support$1=support$5,MADE_BY_DOS=0,MADE_BY_UNIX=3,findCompression=function(e){for(var r in compressions)if(!!Object.prototype.hasOwnProperty.call(compressions,r)&&compressions[r].magic===e)return compressions[r];return null};function ZipEntry$1(e,r){this.options=e,this.loadOptions=r}ZipEntry$1.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(e){var r,t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(t),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(r=findCompression(this.compressionMethod),r===null)throw new Error("Corrupted zip : compression "+utils$2.pretty(this.compressionMethod)+" unknown (inner file : "+utils$2.transformTo("string",this.fileName)+")");this.decompressed=new CompressedObject(this.compressedSize,this.uncompressedSize,this.crc32,r,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var r=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(r),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),e===MADE_BY_DOS&&(this.dosPermissions=this.externalFileAttributes&63),e===MADE_BY_UNIX&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(!!this.extraFields[1]){var e=readerFor$1(this.extraFields[1].value);this.uncompressedSize===utils$2.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===utils$2.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===utils$2.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===utils$2.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var r=e.index+this.extraFieldsLength,t,n,s;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),n=e.readInt(2),s=e.readData(n),this.extraFields[t]={id:t,length:n,value:s};e.setIndex(r)},handleUTF8:function(){var e=support$1.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=utf8$1.utf8decode(this.fileName),this.fileCommentStr=utf8$1.utf8decode(this.fileComment);else{var r=this.findExtraFieldUnicodePath();if(r!==null)this.fileNameStr=r;else{var t=utils$2.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(t)}var n=this.findExtraFieldUnicodeComment();if(n!==null)this.fileCommentStr=n;else{var s=utils$2.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var r=readerFor$1(e.value);return r.readInt(1)!==1||crc32fn(this.fileName)!==r.readInt(4)?null:utf8$1.utf8decode(r.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var r=readerFor$1(e.value);return r.readInt(1)!==1||crc32fn(this.fileComment)!==r.readInt(4)?null:utf8$1.utf8decode(r.readData(e.length-5))}return null}};var zipEntry=ZipEntry$1,readerFor=readerFor$2,utils$1=utils$r,sig=signature$1,ZipEntry=zipEntry,support=support$5;function ZipEntries$1(e){this.files=[],this.loadOptions=e}ZipEntries$1.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var r=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+utils$1.pretty(r)+", expected "+utils$1.pretty(e)+")")}},isSignature:function(e,r){var t=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4),s=n===r;return this.reader.setIndex(t),s},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),r=support.uint8array?"uint8array":"array",t=utils$1.transformTo(r,e);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,r=0,t,n,s;r<e;)t=this.reader.readInt(2),n=this.reader.readInt(4),s=this.reader.readData(n),this.zip64ExtensibleData[t]={id:t,length:n,value:s}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,r;for(e=0;e<this.files.length;e++)r=this.files[e],this.reader.setIndex(r.localHeaderOffset),this.checkSignature(sig.LOCAL_FILE_HEADER),r.readLocalPart(this.reader),r.handleUTF8(),r.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(sig.CENTRAL_FILE_HEADER);)e=new ZipEntry({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(e<0){var r=!this.isSignature(0,sig.LOCAL_FILE_HEADER);throw r?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(e);var t=e;if(this.checkSignature(sig.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===utils$1.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils$1.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===utils$1.MAX_VALUE_16BITS||this.centralDirRecords===utils$1.MAX_VALUE_16BITS||this.centralDirSize===utils$1.MAX_VALUE_32BITS||this.centralDirOffset===utils$1.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),e<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,sig.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var s=t-n;if(s>0)this.isSignature(t,sig.CENTRAL_FILE_HEADER)||(this.reader.zero=s);else if(s<0)throw new Error("Corrupted zip: missing "+Math.abs(s)+" bytes.")},prepareReader:function(e){this.reader=readerFor(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var zipEntries=ZipEntries$1,utils=utils$r,external=external$3,utf8=utf8$5,ZipEntries=zipEntries,Crc32Probe=Crc32Probe_1,nodejsUtils=nodejsUtils$2;function checkEntryCRC32(e){return new external.Promise(function(r,t){var n=e.decompressed.getContentWorker().pipe(new Crc32Probe);n.on("error",function(s){t(s)}).on("end",function(){n.streamInfo.crc32!==e.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):r()}).resume()})}var load=function(e,r){var t=this;return r=utils.extend(r||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:utf8.utf8decode}),nodejsUtils.isNode&&nodejsUtils.isStream(e)?external.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):utils.prepareContent("the loaded zip file",e,!0,r.optimizedBinaryString,r.base64).then(function(n){var s=new ZipEntries(r);return s.load(n),s}).then(function(s){var l=[external.Promise.resolve(s)],u=s.files;if(r.checkCRC32)for(var o=0;o<u.length;o++)l.push(checkEntryCRC32(u[o]));return external.Promise.all(l)}).then(function(s){for(var l=s.shift(),u=l.files,o=0;o<u.length;o++){var m=u[o],_=m.fileNameStr,p=utils.resolve(m.fileNameStr);t.file(p,m.decompressed,{binary:!0,optimizedBinaryString:!0,date:m.date,dir:m.dir,comment:m.fileCommentStr.length?m.fileCommentStr:null,unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions,createFolders:r.createFolders}),m.dir||(t.file(p).unsafeOriginalName=_)}return l.zipComment.length&&(t.comment=l.zipComment),t})};function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new JSZip;for(var r in this)typeof this[r]!="function"&&(e[r]=this[r]);return e}}JSZip.prototype=object,JSZip.prototype.loadAsync=load,JSZip.support=support$5,JSZip.defaults=defaults$1,JSZip.version="3.10.1",JSZip.loadAsync=function(e,r){return new JSZip().loadAsync(e,r)},JSZip.external=external$3;var lib=JSZip;const zipLoad=e=>lib.loadAsync(e),zipGetText=(e,r)=>{const t=e.file(r);return t?t.async("text"):null},zipSetText=(e,r,t)=>e.file(r,t),zipSetBinary=(e,r,t)=>e.file(r,t,{binary:!0}),zipSetBase64=(e,r,t)=>e.file(r,t,{base64:!0}),zipSave=e=>e.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:1}});var sax={},string_decoder={},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(e,r){var t=buffer$1,n=t.Buffer;function s(u,o){for(var m in u)o[m]=u[m]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=t:(s(t,r),r.Buffer=l);function l(u,o,m){return n(u,o,m)}l.prototype=Object.create(n.prototype),s(n,l),l.from=function(u,o,m){if(typeof u=="number")throw new TypeError("Argument must not be a number");return n(u,o,m)},l.alloc=function(u,o,m){if(typeof u!="number")throw new TypeError("Argument must be a number");var _=n(u);return o!==void 0?typeof m=="string"?_.fill(o,m):_.fill(o):_.fill(0),_},l.allocUnsafe=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return n(u)},l.allocUnsafeSlow=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(u)}})(safeBuffer,safeBuffer.exports);var Buffer$1=safeBuffer.exports.Buffer,isEncoding=Buffer$1.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(e){if(!e)return"utf8";for(var r;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(r)return;e=(""+e).toLowerCase(),r=!0}}function normalizeEncoding(e){var r=_normalizeEncoding(e);if(typeof r!="string"&&(Buffer$1.isEncoding===isEncoding||!isEncoding(e)))throw new Error("Unknown encoding: "+e);return r||e}string_decoder.StringDecoder=StringDecoder;function StringDecoder(e){this.encoding=normalizeEncoding(e);var r;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,r=4;break;case"utf8":this.fillLast=utf8FillLast,r=4;break;case"base64":this.text=base64Text,this.end=base64End,r=3;break;default:this.write=simpleWrite,this.end=simpleEnd;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$1.allocUnsafe(r)}StringDecoder.prototype.write=function(e){if(e.length===0)return"";var r,t;if(this.lastNeed){if(r=this.fillLast(e),r===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<e.length?r?r+this.text(e,t):this.text(e,t):r||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function utf8CheckByte(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function utf8CheckIncomplete(e,r,t){var n=r.length-1;if(n<t)return 0;var s=utf8CheckByte(r[n]);return s>=0?(s>0&&(e.lastNeed=s-1),s):--n<t||s===-2?0:(s=utf8CheckByte(r[n]),s>=0?(s>0&&(e.lastNeed=s-2),s):--n<t||s===-2?0:(s=utf8CheckByte(r[n]),s>=0?(s>0&&(s===2?s=0:e.lastNeed=s-3),s):0))}function utf8CheckExtraBytes(e,r,t){if((r[0]&192)!==128)return e.lastNeed=0,"\uFFFD";if(e.lastNeed>1&&r.length>1){if((r[1]&192)!==128)return e.lastNeed=1,"\uFFFD";if(e.lastNeed>2&&r.length>2&&(r[2]&192)!==128)return e.lastNeed=2,"\uFFFD"}}function utf8FillLast(e){var r=this.lastTotal-this.lastNeed,t=utf8CheckExtraBytes(this,e);if(t!==void 0)return t;if(this.lastNeed<=e.length)return e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,r,0,e.length),this.lastNeed-=e.length}function utf8Text(e,r){var t=utf8CheckIncomplete(this,e,r);if(!this.lastNeed)return e.toString("utf8",r);this.lastTotal=t;var n=e.length-(t-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",r,n)}function utf8End(e){var r=e&&e.length?this.write(e):"";return this.lastNeed?r+"\uFFFD":r}function utf16Text(e,r){if((e.length-r)%2===0){var t=e.toString("utf16le",r);if(t){var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",r,e.length-1)}function utf16End(e){var r=e&&e.length?this.write(e):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,t)}return r}function base64Text(e,r){var t=(e.length-r)%3;return t===0?e.toString("base64",r):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",r,e.length-t))}function base64End(e){var r=e&&e.length?this.write(e):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function simpleWrite(e){return e.toString(this.encoding)}function simpleEnd(e){return e&&e.length?this.write(e):""}(function(e){(function(r){r.parser=function(g,h){return new n(g,h)},r.SAXParser=n,r.SAXStream=p,r.createStream=_,r.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];r.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(g,h){if(!(this instanceof n))return new n(g,h);var C=this;l(C),C.q=C.c="",C.bufferCheckPosition=r.MAX_BUFFER_LENGTH,C.opt=h||{},C.opt.lowercase=C.opt.lowercase||C.opt.lowercasetags,C.looseCase=C.opt.lowercase?"toLowerCase":"toUpperCase",C.tags=[],C.closed=C.closedRoot=C.sawRoot=!1,C.tag=C.error=null,C.strict=!!g,C.noscript=!!(g||C.opt.noscript),C.state=y.BEGIN,C.strictEntities=C.opt.strictEntities,C.ENTITIES=C.strictEntities?Object.create(r.XML_ENTITIES):Object.create(r.ENTITIES),C.attribList=[],C.opt.xmlns&&(C.ns=Object.create(I)),C.trackPosition=C.opt.position!==!1,C.trackPosition&&(C.position=C.line=C.column=0),F(C,"onready")}Object.create||(Object.create=function(g){function h(){}h.prototype=g;var C=new h;return C}),Object.keys||(Object.keys=function(g){var h=[];for(var C in g)g.hasOwnProperty(C)&&h.push(C);return h});function s(g){for(var h=Math.max(r.MAX_BUFFER_LENGTH,10),C=0,x=0,j=t.length;x<j;x++){var K=g[t[x]].length;if(K>h)switch(t[x]){case"textNode":te(g);break;case"cdata":Z(g,"oncdata",g.cdata),g.cdata="";break;case"script":Z(g,"onscript",g.script),g.script="";break;default:ne(g,"Max buffer length exceeded: "+t[x])}C=Math.max(C,K)}var X=r.MAX_BUFFER_LENGTH-C;g.bufferCheckPosition=X+g.position}function l(g){for(var h=0,C=t.length;h<C;h++)g[t[h]]=""}function u(g){te(g),g.cdata!==""&&(Z(g,"oncdata",g.cdata),g.cdata=""),g.script!==""&&(Z(g,"onscript",g.script),g.script="")}n.prototype={end:function(){fe(this)},write:ve,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){u(this)}};var o;try{o=require("stream").Stream}catch(g){o=function(){}}var m=r.EVENTS.filter(function(g){return g!=="error"&&g!=="end"});function _(g,h){return new p(g,h)}function p(g,h){if(!(this instanceof p))return new p(g,h);o.apply(this),this._parser=new n(g,h),this.writable=!0,this.readable=!0;var C=this;this._parser.onend=function(){C.emit("end")},this._parser.onerror=function(x){C.emit("error",x),C._parser.error=null},this._decoder=null,m.forEach(function(x){Object.defineProperty(C,"on"+x,{get:function(){return C._parser["on"+x]},set:function(j){if(!j)return C.removeAllListeners(x),C._parser["on"+x]=j,j;C.on(x,j)},enumerable:!0,configurable:!1})})}p.prototype=Object.create(o.prototype,{constructor:{value:p}}),p.prototype.write=function(g){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(g)){if(!this._decoder){var h=string_decoder.StringDecoder;this._decoder=new h("utf8")}g=this._decoder.write(g)}return this._parser.write(g.toString()),this.emit("data",g),!0},p.prototype.end=function(g){return g&&g.length&&this.write(g),this._parser.end(),!0},p.prototype.on=function(g,h){var C=this;return!C._parser["on"+g]&&m.indexOf(g)!==-1&&(C._parser["on"+g]=function(){var x=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);x.splice(0,0,g),C.emit.apply(C,x)}),o.prototype.on.call(C,g,h)};var A="[CDATA[",v="DOCTYPE",w="http://www.w3.org/XML/1998/namespace",T="http://www.w3.org/2000/xmlns/",I={xml:w,xmlns:T},N=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,k=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,D=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,B=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function R(g){return g===" "||g===`
`||g==="\r"||g==="	"}function O(g){return g==='"'||g==="'"}function P(g){return g===">"||R(g)}function L(g,h){return g.test(h)}function M(g,h){return!L(g,h)}var y=0;r.STATE={BEGIN:y++,BEGIN_WHITESPACE:y++,TEXT:y++,TEXT_ENTITY:y++,OPEN_WAKA:y++,SGML_DECL:y++,SGML_DECL_QUOTED:y++,DOCTYPE:y++,DOCTYPE_QUOTED:y++,DOCTYPE_DTD:y++,DOCTYPE_DTD_QUOTED:y++,COMMENT_STARTING:y++,COMMENT:y++,COMMENT_ENDING:y++,COMMENT_ENDED:y++,CDATA:y++,CDATA_ENDING:y++,CDATA_ENDING_2:y++,PROC_INST:y++,PROC_INST_BODY:y++,PROC_INST_ENDING:y++,OPEN_TAG:y++,OPEN_TAG_SLASH:y++,ATTRIB:y++,ATTRIB_NAME:y++,ATTRIB_NAME_SAW_WHITE:y++,ATTRIB_VALUE:y++,ATTRIB_VALUE_QUOTED:y++,ATTRIB_VALUE_CLOSED:y++,ATTRIB_VALUE_UNQUOTED:y++,ATTRIB_VALUE_ENTITY_Q:y++,ATTRIB_VALUE_ENTITY_U:y++,CLOSE_TAG:y++,CLOSE_TAG_SAW_WHITE:y++,SCRIPT:y++,SCRIPT_ENDING:y++},r.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},r.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(r.ENTITIES).forEach(function(g){var h=r.ENTITIES[g],C=typeof h=="number"?String.fromCharCode(h):h;r.ENTITIES[g]=C});for(var U in r.STATE)r.STATE[r.STATE[U]]=U;y=r.STATE;function F(g,h,C){g[h]&&g[h](C)}function Z(g,h,C){g.textNode&&te(g),F(g,h,C)}function te(g){g.textNode=ie(g.opt,g.textNode),g.textNode&&F(g,"ontext",g.textNode),g.textNode=""}function ie(g,h){return g.trim&&(h=h.trim()),g.normalize&&(h=h.replace(/\s+/g," ")),h}function ne(g,h){return te(g),g.trackPosition&&(h+=`
Line: `+g.line+`
Column: `+g.column+`
Char: `+g.c),h=new Error(h),g.error=h,F(g,"onerror",h),g}function fe(g){return g.sawRoot&&!g.closedRoot&&H(g,"Unclosed root tag"),g.state!==y.BEGIN&&g.state!==y.BEGIN_WHITESPACE&&g.state!==y.TEXT&&ne(g,"Unexpected end"),te(g),g.c="",g.closed=!0,F(g,"onend"),n.call(g,g.strict,g.opt),g}function H(g,h){if(typeof g!="object"||!(g instanceof n))throw new Error("bad call to strictFail");g.strict&&ne(g,h)}function se(g){g.strict||(g.tagName=g.tagName[g.looseCase]());var h=g.tags[g.tags.length-1]||g,C=g.tag={name:g.tagName,attributes:{}};g.opt.xmlns&&(C.ns=h.ns),g.attribList.length=0,Z(g,"onopentagstart",C)}function he(g,h){var C=g.indexOf(":"),x=C<0?["",g]:g.split(":"),j=x[0],K=x[1];return h&&g==="xmlns"&&(j="xmlns",K=""),{prefix:j,local:K}}function _e(g){if(g.strict||(g.attribName=g.attribName[g.looseCase]()),g.attribList.indexOf(g.attribName)!==-1||g.tag.attributes.hasOwnProperty(g.attribName)){g.attribName=g.attribValue="";return}if(g.opt.xmlns){var h=he(g.attribName,!0),C=h.prefix,x=h.local;if(C==="xmlns")if(x==="xml"&&g.attribValue!==w)H(g,"xml: prefix must be bound to "+w+`
Actual: `+g.attribValue);else if(x==="xmlns"&&g.attribValue!==T)H(g,"xmlns: prefix must be bound to "+T+`
Actual: `+g.attribValue);else{var j=g.tag,K=g.tags[g.tags.length-1]||g;j.ns===K.ns&&(j.ns=Object.create(K.ns)),j.ns[x]=g.attribValue}g.attribList.push([g.attribName,g.attribValue])}else g.tag.attributes[g.attribName]=g.attribValue,Z(g,"onattribute",{name:g.attribName,value:g.attribValue});g.attribName=g.attribValue=""}function G(g,h){if(g.opt.xmlns){var C=g.tag,x=he(g.tagName);C.prefix=x.prefix,C.local=x.local,C.uri=C.ns[x.prefix]||"",C.prefix&&!C.uri&&(H(g,"Unbound namespace prefix: "+JSON.stringify(g.tagName)),C.uri=x.prefix);var j=g.tags[g.tags.length-1]||g;C.ns&&j.ns!==C.ns&&Object.keys(C.ns).forEach(function(ae){Z(g,"onopennamespace",{prefix:ae,uri:C.ns[ae]})});for(var K=0,X=g.attribList.length;K<X;K++){var ee=g.attribList[K],oe=ee[0],ue=ee[1],Q=he(oe,!0),le=Q.prefix,we=Q.local,ge=le===""?"":C.ns[le]||"",ce={name:oe,value:ue,prefix:le,local:we,uri:ge};le&&le!=="xmlns"&&!ge&&(H(g,"Unbound namespace prefix: "+JSON.stringify(le)),ce.uri=le),g.tag.attributes[oe]=ce,Z(g,"onattribute",ce)}g.attribList.length=0}g.tag.isSelfClosing=!!h,g.sawRoot=!0,g.tags.push(g.tag),Z(g,"onopentag",g.tag),h||(!g.noscript&&g.tagName.toLowerCase()==="script"?g.state=y.SCRIPT:g.state=y.TEXT,g.tag=null,g.tagName=""),g.attribName=g.attribValue="",g.attribList.length=0}function re(g){if(!g.tagName){H(g,"Weird empty close tag."),g.textNode+="</>",g.state=y.TEXT;return}if(g.script){if(g.tagName!=="script"){g.script+="</"+g.tagName+">",g.tagName="",g.state=y.SCRIPT;return}Z(g,"onscript",g.script),g.script=""}var h=g.tags.length,C=g.tagName;g.strict||(C=C[g.looseCase]());for(var x=C;h--;){var j=g.tags[h];if(j.name!==x)H(g,"Unexpected close tag");else break}if(h<0){H(g,"Unmatched closing tag: "+g.tagName),g.textNode+="</"+g.tagName+">",g.state=y.TEXT;return}g.tagName=C;for(var K=g.tags.length;K-- >h;){var X=g.tag=g.tags.pop();g.tagName=g.tag.name,Z(g,"onclosetag",g.tagName);var ee={};for(var oe in X.ns)ee[oe]=X.ns[oe];var ue=g.tags[g.tags.length-1]||g;g.opt.xmlns&&X.ns!==ue.ns&&Object.keys(X.ns).forEach(function(Q){var le=X.ns[Q];Z(g,"onclosenamespace",{prefix:Q,uri:le})})}h===0&&(g.closedRoot=!0),g.tagName=g.attribValue=g.attribName="",g.attribList.length=0,g.state=y.TEXT}function Ee(g){var h=g.entity,C=h.toLowerCase(),x,j="";return g.ENTITIES[h]?g.ENTITIES[h]:g.ENTITIES[C]?g.ENTITIES[C]:(h=C,h.charAt(0)==="#"&&(h.charAt(1)==="x"?(h=h.slice(2),x=parseInt(h,16),j=x.toString(16)):(h=h.slice(1),x=parseInt(h,10),j=x.toString(10))),h=h.replace(/^0+/,""),isNaN(x)||j.toLowerCase()!==h?(H(g,"Invalid character entity"),"&"+g.entity+";"):String.fromCodePoint(x))}function pe(g,h){h==="<"?(g.state=y.OPEN_WAKA,g.startTagPosition=g.position):R(h)||(H(g,"Non-whitespace before first tag."),g.textNode=h,g.state=y.TEXT)}function me(g,h){var C="";return h<g.length&&(C=g.charAt(h)),C}function ve(g){var h=this;if(this.error)throw this.error;if(h.closed)return ne(h,"Cannot write after close. Assign an onready handler.");if(g===null)return fe(h);typeof g=="object"&&(g=g.toString());for(var C=0,x="";x=me(g,C++),h.c=x,!!x;)switch(h.trackPosition&&(h.position++,x===`
`?(h.line++,h.column=0):h.column++),h.state){case y.BEGIN:if(h.state=y.BEGIN_WHITESPACE,x==="\uFEFF")continue;pe(h,x);continue;case y.BEGIN_WHITESPACE:pe(h,x);continue;case y.TEXT:if(h.sawRoot&&!h.closedRoot){for(var j=C-1;x&&x!=="<"&&x!=="&";)x=me(g,C++),x&&h.trackPosition&&(h.position++,x===`
`?(h.line++,h.column=0):h.column++);h.textNode+=g.substring(j,C-1)}x==="<"&&!(h.sawRoot&&h.closedRoot&&!h.strict)?(h.state=y.OPEN_WAKA,h.startTagPosition=h.position):(!R(x)&&(!h.sawRoot||h.closedRoot)&&H(h,"Text data outside of root node."),x==="&"?h.state=y.TEXT_ENTITY:h.textNode+=x);continue;case y.SCRIPT:x==="<"?h.state=y.SCRIPT_ENDING:h.script+=x;continue;case y.SCRIPT_ENDING:x==="/"?h.state=y.CLOSE_TAG:(h.script+="<"+x,h.state=y.SCRIPT);continue;case y.OPEN_WAKA:if(x==="!")h.state=y.SGML_DECL,h.sgmlDecl="";else if(!R(x))if(L(N,x))h.state=y.OPEN_TAG,h.tagName=x;else if(x==="/")h.state=y.CLOSE_TAG,h.tagName="";else if(x==="?")h.state=y.PROC_INST,h.procInstName=h.procInstBody="";else{if(H(h,"Unencoded <"),h.startTagPosition+1<h.position){var K=h.position-h.startTagPosition;x=new Array(K).join(" ")+x}h.textNode+="<"+x,h.state=y.TEXT}continue;case y.SGML_DECL:(h.sgmlDecl+x).toUpperCase()===A?(Z(h,"onopencdata"),h.state=y.CDATA,h.sgmlDecl="",h.cdata=""):h.sgmlDecl+x==="--"?(h.state=y.COMMENT,h.comment="",h.sgmlDecl=""):(h.sgmlDecl+x).toUpperCase()===v?(h.state=y.DOCTYPE,(h.doctype||h.sawRoot)&&H(h,"Inappropriately located doctype declaration"),h.doctype="",h.sgmlDecl=""):x===">"?(Z(h,"onsgmldeclaration",h.sgmlDecl),h.sgmlDecl="",h.state=y.TEXT):(O(x)&&(h.state=y.SGML_DECL_QUOTED),h.sgmlDecl+=x);continue;case y.SGML_DECL_QUOTED:x===h.q&&(h.state=y.SGML_DECL,h.q=""),h.sgmlDecl+=x;continue;case y.DOCTYPE:x===">"?(h.state=y.TEXT,Z(h,"ondoctype",h.doctype),h.doctype=!0):(h.doctype+=x,x==="["?h.state=y.DOCTYPE_DTD:O(x)&&(h.state=y.DOCTYPE_QUOTED,h.q=x));continue;case y.DOCTYPE_QUOTED:h.doctype+=x,x===h.q&&(h.q="",h.state=y.DOCTYPE);continue;case y.DOCTYPE_DTD:h.doctype+=x,x==="]"?h.state=y.DOCTYPE:O(x)&&(h.state=y.DOCTYPE_DTD_QUOTED,h.q=x);continue;case y.DOCTYPE_DTD_QUOTED:h.doctype+=x,x===h.q&&(h.state=y.DOCTYPE_DTD,h.q="");continue;case y.COMMENT:x==="-"?h.state=y.COMMENT_ENDING:h.comment+=x;continue;case y.COMMENT_ENDING:x==="-"?(h.state=y.COMMENT_ENDED,h.comment=ie(h.opt,h.comment),h.comment&&Z(h,"oncomment",h.comment),h.comment=""):(h.comment+="-"+x,h.state=y.COMMENT);continue;case y.COMMENT_ENDED:x!==">"?(H(h,"Malformed comment"),h.comment+="--"+x,h.state=y.COMMENT):h.state=y.TEXT;continue;case y.CDATA:x==="]"?h.state=y.CDATA_ENDING:h.cdata+=x;continue;case y.CDATA_ENDING:x==="]"?h.state=y.CDATA_ENDING_2:(h.cdata+="]"+x,h.state=y.CDATA);continue;case y.CDATA_ENDING_2:x===">"?(h.cdata&&Z(h,"oncdata",h.cdata),Z(h,"onclosecdata"),h.cdata="",h.state=y.TEXT):x==="]"?h.cdata+="]":(h.cdata+="]]"+x,h.state=y.CDATA);continue;case y.PROC_INST:x==="?"?h.state=y.PROC_INST_ENDING:R(x)?h.state=y.PROC_INST_BODY:h.procInstName+=x;continue;case y.PROC_INST_BODY:if(!h.procInstBody&&R(x))continue;x==="?"?h.state=y.PROC_INST_ENDING:h.procInstBody+=x;continue;case y.PROC_INST_ENDING:x===">"?(Z(h,"onprocessinginstruction",{name:h.procInstName,body:h.procInstBody}),h.procInstName=h.procInstBody="",h.state=y.TEXT):(h.procInstBody+="?"+x,h.state=y.PROC_INST_BODY);continue;case y.OPEN_TAG:L(k,x)?h.tagName+=x:(se(h),x===">"?G(h):x==="/"?h.state=y.OPEN_TAG_SLASH:(R(x)||H(h,"Invalid character in tag name"),h.state=y.ATTRIB));continue;case y.OPEN_TAG_SLASH:x===">"?(G(h,!0),re(h)):(H(h,"Forward-slash in opening tag not followed by >"),h.state=y.ATTRIB);continue;case y.ATTRIB:if(R(x))continue;x===">"?G(h):x==="/"?h.state=y.OPEN_TAG_SLASH:L(N,x)?(h.attribName=x,h.attribValue="",h.state=y.ATTRIB_NAME):H(h,"Invalid attribute name");continue;case y.ATTRIB_NAME:x==="="?h.state=y.ATTRIB_VALUE:x===">"?(H(h,"Attribute without value"),h.attribValue=h.attribName,_e(h),G(h)):R(x)?h.state=y.ATTRIB_NAME_SAW_WHITE:L(k,x)?h.attribName+=x:H(h,"Invalid attribute name");continue;case y.ATTRIB_NAME_SAW_WHITE:if(x==="=")h.state=y.ATTRIB_VALUE;else{if(R(x))continue;H(h,"Attribute without value"),h.tag.attributes[h.attribName]="",h.attribValue="",Z(h,"onattribute",{name:h.attribName,value:""}),h.attribName="",x===">"?G(h):L(N,x)?(h.attribName=x,h.state=y.ATTRIB_NAME):(H(h,"Invalid attribute name"),h.state=y.ATTRIB)}continue;case y.ATTRIB_VALUE:if(R(x))continue;O(x)?(h.q=x,h.state=y.ATTRIB_VALUE_QUOTED):(H(h,"Unquoted attribute value"),h.state=y.ATTRIB_VALUE_UNQUOTED,h.attribValue=x);continue;case y.ATTRIB_VALUE_QUOTED:if(x!==h.q){x==="&"?h.state=y.ATTRIB_VALUE_ENTITY_Q:h.attribValue+=x;continue}_e(h),h.q="",h.state=y.ATTRIB_VALUE_CLOSED;continue;case y.ATTRIB_VALUE_CLOSED:R(x)?h.state=y.ATTRIB:x===">"?G(h):x==="/"?h.state=y.OPEN_TAG_SLASH:L(N,x)?(H(h,"No whitespace between attributes"),h.attribName=x,h.attribValue="",h.state=y.ATTRIB_NAME):H(h,"Invalid attribute name");continue;case y.ATTRIB_VALUE_UNQUOTED:if(!P(x)){x==="&"?h.state=y.ATTRIB_VALUE_ENTITY_U:h.attribValue+=x;continue}_e(h),x===">"?G(h):h.state=y.ATTRIB;continue;case y.CLOSE_TAG:if(h.tagName)x===">"?re(h):L(k,x)?h.tagName+=x:h.script?(h.script+="</"+h.tagName,h.tagName="",h.state=y.SCRIPT):(R(x)||H(h,"Invalid tagname in closing tag"),h.state=y.CLOSE_TAG_SAW_WHITE);else{if(R(x))continue;M(N,x)?h.script?(h.script+="</"+x,h.state=y.SCRIPT):H(h,"Invalid tagname in closing tag."):h.tagName=x}continue;case y.CLOSE_TAG_SAW_WHITE:if(R(x))continue;x===">"?re(h):H(h,"Invalid characters in closing tag");continue;case y.TEXT_ENTITY:case y.ATTRIB_VALUE_ENTITY_Q:case y.ATTRIB_VALUE_ENTITY_U:var X,ee;switch(h.state){case y.TEXT_ENTITY:X=y.TEXT,ee="textNode";break;case y.ATTRIB_VALUE_ENTITY_Q:X=y.ATTRIB_VALUE_QUOTED,ee="attribValue";break;case y.ATTRIB_VALUE_ENTITY_U:X=y.ATTRIB_VALUE_UNQUOTED,ee="attribValue";break}x===";"?(h[ee]+=Ee(h),h.entity="",h.state=X):L(h.entity.length?B:D,x)?h.entity+=x:(H(h,"Invalid character in entity name"),h[ee]+="&"+h.entity+x,h.entity="",h.state=X);continue;default:throw new Error(h,"Unknown state: "+h.state)}return h.position>=h.bufferCheckPosition&&s(h),h}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var g=String.fromCharCode,h=Math.floor,C=function(){var x=16384,j=[],K,X,ee=-1,oe=arguments.length;if(!oe)return"";for(var ue="";++ee<oe;){var Q=Number(arguments[ee]);if(!isFinite(Q)||Q<0||Q>1114111||h(Q)!==Q)throw RangeError("Invalid code point: "+Q);Q<=65535?j.push(Q):(Q-=65536,K=(Q>>10)+55296,X=Q%1024+56320,j.push(K,X)),(ee+1===oe||j.length>x)&&(ue+=g.apply(null,j),j.length=0)}return ue};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:C,configurable:!0,writable:!0}):String.fromCodePoint=C}()})(e)})(sax);const logger={debug:()=>{}},parseXml=e=>{const r=sax.parser(!0,{trim:!1,normalize:!1});let t,n=null,s=0;return new Promise((l,u)=>{r.onopentag=o=>{const m={_parent:n||void 0,_children:[],_fTextNode:!1,_tag:o.name,_attrs:o.attributes};n!=null?n._children.push(m):t=m,n=m,s+=1},r.onclosetag=()=>{n=n!=null?n._parent:null},r.ontext=o=>{n!=null&&n._children.push({_parent:n,_children:[],_fTextNode:!0,_text:o})},r.onend=()=>{logger.debug(`Number of XML elements: ${s}`),l(t)},r.onerror=o=>{u(o)},r.write(e),r.end()})},buildXml=(e,r,t="")=>{let n=t.length?"":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';if(e._fTextNode)n+=sanitizeText(e._text,r);else{let s="";const l=e._attrs;Object.keys(l).forEach(_=>{s+=` ${_}="${sanitizeAttr(l[_])}"`});const u=e._children.length>0,o=u?"":"/";n+=`
${t}<${e._tag}${s}${o}>`;let m=!1;e._children.forEach(_=>{n+=buildXml(_,r,`${t}  `),m=!_._fTextNode}),u&&(n+=`${m?`
${t}`:""}</${e._tag}>`)}return n},sanitizeText=(e,r)=>{let t="";const n=e.split(r.literalXmlDelimiter);let s=!1;for(let l=0;l<n.length;l++){let u=n[l];s||(u=u.replace(/&/g,"&amp;"),u=u.replace(/</g,"&lt;"),u=u.replace(/>/g,"&gt;")),t+=u,s=!s}return t},sanitizeAttr=e=>{let r=typeof e=="string"?e:e.value;return r=r.replace(/&/g,"&amp;"),r=r.replace(/</g,"&lt;"),r=r.replace(/>/g,"&gt;"),r=r.replace(/'/g,"&apos;"),r=r.replace(/"/g,"&quot;"),r};class NullishCommandResultError extends Error{constructor(r){super(`Result of command ${r} is null or undefined and rejectNullish is set`);Object.setPrototypeOf(this,NullishCommandResultError.prototype),this.command=r}}class ObjectCommandResultError extends Error{constructor(r){super(`Result of command '${r}' is an object`);Object.setPrototypeOf(this,ObjectCommandResultError.prototype),this.command=r}}class CommandSyntaxError extends Error{constructor(r){super(`Invalid command syntax: ${r}`);Object.setPrototypeOf(this,CommandSyntaxError.prototype),this.command=r}}class InvalidCommandError extends Error{constructor(r,t){super(`${r}: ${t}`);Object.setPrototypeOf(this,InvalidCommandError.prototype),this.command=t}}class CommandExecutionError extends Error{constructor(r,t){super(`Error executing command '${t}': ${r.message}`);Object.setPrototypeOf(this,CommandExecutionError.prototype),this.command=t,this.err=r}}class ImageError extends CommandExecutionError{}class InternalError extends Error{constructor(r){super(`INTERNAL ERROR: ${r}`)}}class TemplateParseError extends Error{}class IncompleteConditionalStatementError extends Error{constructor(){super("Incomplete IF/END-IF statement. Make sure each IF-statement has a corresponding END-IF command.")}}const cloneNodeWithoutChildren=e=>e._fTextNode?{_children:[],_fTextNode:!0,_text:e._text}:{_children:[],_fTextNode:!1,_tag:e._tag,_attrs:e._attrs},getNextSibling=e=>{const r=e._parent;if(r==null)return null;const t=r._children,n=t.indexOf(e);return n<0||n>=t.length-1?null:t[n+1]},insertTextSiblingAfter=e=>{const r=e._parent;if(!(r&&!r._fTextNode&&r._tag==="w:t"))throw new TemplateParseError("Template syntax error: text node not within w:t");const t=r._parent;if(t==null)throw new TemplateParseError("Template syntax error: w:t node has no parent");const n=t._children.indexOf(r);if(n<0)throw new TemplateParseError("Template syntax error");const s=cloneNodeWithoutChildren(r);s._parent=t;const l={_parent:s,_children:[],_fTextNode:!0,_text:""};return s._children=[l],t._children.splice(n+1,0,s),l},newNonTextNode=(e,r={},t=[])=>{const n={_fTextNode:!1,_tag:e,_attrs:r,_children:t};return n._children.forEach(s=>{s._parent=n}),n},newTextNode=e=>({_children:[],_fTextNode:!0,_text:e}),addChild=(e,r)=>(e._children.push(r),r._parent=e,r),getCurLoop=e=>e.loops.length?e.loops[e.loops.length-1]:null,isLoopExploring=e=>{const r=getCurLoop(e);return r!=null&&r.idx<0},logLoop=e=>{if(!e.length)return;const r=e.length-1,{varName:t,idx:n,loopOver:s,isIf:l}=e[r],u=n>=0?n+1:"EXPLORATION";logger.debug(`${l?"IF":"FOR"} loop on ${r}:${t}${u}/${s.length}`)},preprocessTemplate=(e,r)=>{let t=e,n=!1,s=null,l=0;const u=`${r[0]}CMD_NODE${r[1]}`;for(;t!=null;){if(!t._fTextNode&&t._tag==="w:t"&&(t._attrs["xml:space"]="preserve"),!t._fTextNode&&t._tag==="w:p"&&s&&(s._text+=" "),t._fTextNode&&t._parent&&!t._parent._fTextNode&&t._parent._tag==="w:t"){s==null&&(s=t);const o=t._text;t._text="";for(let m=0;m<o.length;m++){const _=o[m],p=n?r[1]:r[0];if(_===p[l]){if(l+=1,l===p.length){n=!n;const A=t===s;n&&s._text.length&&(s=insertTextSiblingAfter(s),A&&(t=s)),s._text+=p,!n&&m<o.length-1&&(s=insertTextSiblingAfter(s),A&&(t=s)),l=0,n||(s=t)}}else l&&(s._text+=p.slice(0,l),l=0,n||(s=t)),s._text+=_}!n&&!l&&(s=null),o.length&&!t._text.length&&(t._text=u)}if(t._children.length)t=t._children[0];else{let o=!1;for(;t._parent!=null;){const m=t._parent,_=getNextSibling(t);if(_){o=!0,t=_;break}t=m}o||(t=null)}}return e};var vmBrowserify={};(function(exports){var indexOf=function(e,r){if(e.indexOf)return e.indexOf(r);for(var t=0;t<e.length;t++)if(e[t]===r)return t;return-1},Object_keys=function(e){if(Object.keys)return Object.keys(e);var r=[];for(var t in e)r.push(t);return r},forEach=function(e,r){if(e.forEach)return e.forEach(r);for(var t=0;t<e.length;t++)r(e[t],t,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,r,t){Object.defineProperty(e,r,{writable:!0,enumerable:!1,configurable:!0,value:t})}}catch(e){return function(r,t,n){r[t]=n}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(r){if(!(this instanceof Script))return new Script(r);this.code=r};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var r=document.createElement("iframe");r.style||(r.style={}),r.style.display="none",document.body.appendChild(r);var t=r.contentWindow,n=t.eval,s=t.execScript;!n&&s&&(s.call(t,"null"),n=t.eval),forEach(Object_keys(e),function(o){t[o]=e[o]}),forEach(globals,function(o){e[o]&&(t[o]=e[o])});var l=Object_keys(t),u=n.call(t,this.code);return forEach(Object_keys(t),function(o){(o in e||indexOf(l,o)===-1)&&(e[o]=t[o])}),forEach(globals,function(o){o in e||defineProp(e,o,t[o])}),document.body.removeChild(r),u},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var r=Script.createContext(e),t=this.runInContext(r);return e&&forEach(Object_keys(r),function(n){e[n]=r[n]}),t},forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(r){var t=Script(r);return t[e].apply(t,[].slice.call(arguments,1))}}),exports.isContext=function(e){return e instanceof Context},exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var r=new Context;return typeof e=="object"&&forEach(Object_keys(e),function(t){r[t]=e[t]}),r}})(vmBrowserify);var timm$1={};Object.defineProperty(timm$1,"__esModule",{value:!0}),timm$1.clone=clone,timm$1.addLast=addLast,timm$1.addFirst=addFirst,timm$1.removeLast=removeLast,timm$1.removeFirst=removeFirst,timm$1.insert=insert,timm$1.removeAt=removeAt,timm$1.replaceAt=replaceAt,timm$1.getIn=getIn,timm$1.set=set,timm$1.setIn=setIn,timm$1.update=update,timm$1.updateIn=updateIn;var merge_1=timm$1.merge=merge;timm$1.mergeDeep=mergeDeep,timm$1.mergeIn=mergeIn;var omit_1=timm$1.omit=omit;timm$1.addDefaults=addDefaults,timm$1.default=void 0;/*!
 * Timm
 *
 * Immutability helpers with fast reads and acceptable writes.
 *
 * @copyright Guillermo Grau Panea 2016
 * @license MIT
 */const INVALID_ARGS="INVALID_ARGS";function throwStr(e){throw new Error(e)}function getKeysAndSymbols(e){const r=Object.keys(e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r}const hasOwnProperty={}.hasOwnProperty;function clone(e){if(Array.isArray(e))return e.slice();const r=e,t=getKeysAndSymbols(r),n={};for(let s=0;s<t.length;s++){const l=t[s];n[l]=r[l]}return n}function isObject(e){return e!=null&&typeof e=="object"}function addLast(e,r){return Array.isArray(r)?e.concat(r):e.concat([r])}function addFirst(e,r){return Array.isArray(r)?r.concat(e):[r].concat(e)}function removeLast(e){return e.length?e.slice(0,e.length-1):e}function removeFirst(e){return e.length?e.slice(1):e}function insert(e,r,t){return e.slice(0,r).concat(Array.isArray(t)?t:[t]).concat(e.slice(r))}function removeAt(e,r){return r>=e.length||r<0?e:e.slice(0,r).concat(e.slice(r+1))}function replaceAt(e,r,t){if(e[r]===t)return e;const n=e.length,s=Array(n);for(let l=0;l<n;l++)s[l]=e[l];return s[r]=t,s}function getIn(e,r){if(Array.isArray(r)||throwStr(INVALID_ARGS),e==null)return;let t=e;for(let n=0;n<r.length;n++){const s=r[n];if(t=t!=null?t[s]:void 0,t===void 0)return t}return t}function set(e,r,t){let n=e;if(n==null&&(n=typeof r=="number"?[]:{}),n[r]===t)return n;const s=clone(n);return s[r]=t,s}function setIn(e,r,t){return r.length?doSetIn(e,r,t,0):t}function doSetIn(e,r,t,n){let s;const l=r[n];if(n===r.length-1)s=t;else{const u=isObject(e)&&isObject(e[l])?e[l]:typeof r[n+1]=="number"?[]:{};s=doSetIn(u,r,t,n+1)}return set(e,l,s)}function update(e,r,t){const n=e==null?void 0:e[r],s=t(n);return set(e,r,s)}function updateIn(e,r,t){const n=getIn(e,r),s=t(n);return setIn(e,r,s)}function merge(e,r,t,n,s,l,...u){return u.length?doMerge.call(null,!1,!1,e,r,t,n,s,l,...u):doMerge(!1,!1,e,r,t,n,s,l)}function mergeDeep(e,r,t,n,s,l,...u){return u.length?doMerge.call(null,!1,!0,e,r,t,n,s,l,...u):doMerge(!1,!0,e,r,t,n,s,l)}function mergeIn(e,r,t,n,s,l,u,...o){let m=getIn(e,r);m==null&&(m={});let _;return o.length?_=doMerge.call(null,!1,!1,m,t,n,s,l,u,...o):_=doMerge(!1,!1,m,t,n,s,l,u),setIn(e,r,_)}function omit(e,r){const t=Array.isArray(r)?r:[r];let n=!1;for(let u=0;u<t.length;u++)if(hasOwnProperty.call(e,t[u])){n=!0;break}if(!n)return e;const s={},l=getKeysAndSymbols(e);for(let u=0;u<l.length;u++){const o=l[u];t.indexOf(o)>=0||(s[o]=e[o])}return s}function addDefaults(e,r,t,n,s,l,...u){return u.length?doMerge.call(null,!0,!1,e,r,t,n,s,l,...u):doMerge(!0,!1,e,r,t,n,s,l)}function doMerge(e,r,t,...n){let s=t;s==null&&throwStr(INVALID_ARGS);let l=!1;for(let u=0;u<n.length;u++){const o=n[u];if(o==null)continue;const m=getKeysAndSymbols(o);if(!!m.length)for(let _=0;_<=m.length;_++){const p=m[_];if(e&&s[p]!==void 0)continue;let A=o[p];r&&isObject(s[p])&&isObject(A)&&(A=doMerge(e,r,s[p],A)),!(A===void 0||A===s[p])&&(l||(l=!0,s=clone(s)),s[p]=A)}}return s}const timm={clone,addLast,addFirst,removeLast,removeFirst,insert,removeAt,replaceAt,getIn,set,setIn,update,updateIn,merge,mergeDeep,mergeIn,omit,addDefaults};var _default=timm;timm$1.default=_default;async function runUserJsAndGetRaw(e,r,t){const n=merge_1(t.jsSandbox||{},{__code__:r,__result__:void 0},e,t.options.additionalJsContext),s=getCurLoop(t);s&&(n.$idx=s.idx),Object.keys(t.vars).forEach(o=>{n[`$${o}`]=t.vars[o]});let l,u;try{if(t.options.runJs){const o=t.options.runJs({sandbox:n,ctx:t});l=o.modifiedSandbox,u=await o.result}else if(t.options.noSandbox)l=n,u=await new Function("with(this) { return eval(__code__); }").call(l);else{const o=new vmBrowserify.Script(`
      __result__ = eval(__code__);
      `,{});l=vmBrowserify.createContext(n),o.runInContext(l),u=await l.__result__}}catch(o){const m=o instanceof Error?o:new Error(`${o}`);if(t.options.errorHandler!=null)l=n,u=await t.options.errorHandler(m,r);else throw new CommandExecutionError(m,r)}if(t.options.rejectNullish&&u==null){const o=new NullishCommandResultError(r);if(t.options.errorHandler!=null)u=await t.options.errorHandler(o,r);else throw o}return t.jsSandbox=omit_1(l,["__code__","__result__"]),u}const ImageExtensions=[".png",".gif",".jpg",".jpeg",".svg"],BUILT_IN_COMMANDS=["QUERY","CMD_NODE","ALIAS","FOR","END-FOR","IF","END-IF","INS","EXEC","IMAGE","LINK","HTML"];var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,r,t)=>r in e?__defProp(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,__spreadValues=(e,r)=>{for(var t in r||(r={}))__hasOwnProp.call(r,t)&&__defNormalProp(e,t,r[t]);if(__getOwnPropSymbols)for(var t of __getOwnPropSymbols(r))__propIsEnum.call(r,t)&&__defNormalProp(e,t,r[t]);return e},__spreadProps=(e,r)=>__defProps(e,__getOwnPropDescs(r));function newContext(e,r=0){return{gCntIf:0,gCntEndIf:0,level:1,fCmd:!1,cmd:"",fSeekQuery:!1,buffers:{"w:p":{text:"",cmds:"",fInsertedText:!1},"w:tr":{text:"",cmds:"",fInsertedText:!1}},imageAndShapeIdIncrement:r,images:{},linkId:0,links:{},htmlId:0,htmls:{},vars:{},loops:[],fJump:!1,shorthands:{},options:e}}async function extractQuery(e,r){const t=newContext(r);t.fSeekQuery=!0;let n=e;for(;;){if(n._children.length)n=n._children[0];else{let l=!1;for(;n._parent!=null;){const u=n._parent,o=getNextSibling(n);if(o){n=o,l=!0;break}n=u}if(!l)break}if(!n)break;const s=n._parent;if(n._fTextNode&&s&&!s._fTextNode&&s._tag==="w:t"&&await processText(null,n,t,processCmd),t.query!=null)break}return t.query}async function produceJsReport(e,r,t){return walkTemplate(e,r,t,processCmd)}function findHighestImgId(e){const r=[],t=n=>{for(const s of n._children){const l=s._fTextNode?null:s._tag;if(l!=null){if(l==="wp:docPr"){if(s._fTextNode)continue;const u=s._attrs.id;if(typeof u!="string")continue;const o=Number.parseInt(u,10);Number.isSafeInteger(o)&&r.push(o)}s._children.length>0&&t(s)}}};return t(e),r.length>0?Math.max(...r):0}const debugPrintNode=e=>JSON.stringify(e._fTextNode?{_ifName:e._ifName,_fTextNode:e._fTextNode,_text:e==null?void 0:e._text}:{_ifName:e._ifName,_fTextNode:e._fTextNode,_tag:e==null?void 0:e._tag,_attrs:e==null?void 0:e._attrs});async function walkTemplate(e,r,t,n){var s;const l=cloneNodeWithoutChildren(r);let u=r,o=l,m,_=0;const p=[];for(;;){const A=getCurLoop(t);let v=null;if(t.fJump){if(!A)throw new InternalError("jumping while curLoop is null");logger.debug(`Jumping to level ${A.refNodeLevel}...`,debugPrintNode(A.refNode)),_=t.level-A.refNodeLevel,u=A.refNode,t.level=A.refNodeLevel,t.fJump=!1,m="JUMP"}else if(u._children.length&&m!=="UP")u=u._children[0],t.level+=1,m="DOWN";else if(v=getNextSibling(u))u=v,m="SIDE";else{const w=u._parent;if(w==null)break;u=w,t.level-=1,m="UP"}if(logger.debug(`Next node [${m}, level ${t.level}]`,debugPrintNode(u)),m!=="DOWN"){const w=o._fTextNode?null:o._tag;let T=!1;if((w==="w:p"||w==="w:tbl"||w==="w:tr")&&isLoopExploring(t))T=!0;else if(w==="w:p"||w==="w:tr"){const I=t.buffers[w];T=I.text===""&&I.cmds!==""&&!I.fInsertedText}T&&o._parent!=null&&o._parent._children.pop()}if(m==="UP"){isLoopExploring(t)&&A&&u===A.refNode._parent&&(A.refNode=u,A.refNodeLevel-=1,logger.debug(`Updated loop '${A.varName}' refNode: `+debugPrintNode(u)));const w=o._parent;if(w==null)throw new InternalError("node parent is null");if(o=w,t.pendingImageNode&&!o._fTextNode&&o._tag==="w:t"){const T=t.pendingImageNode.image,I=t.pendingImageNode.caption,N=o._parent;N&&(T._parent=N,N._children.pop(),N._children.push(T),I&&N._children.push(...I),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0),delete t.pendingImageNode}if(t.pendingLinkNode&&!o._fTextNode&&o._tag==="w:r"){const T=t.pendingLinkNode,I=o._parent;I&&(T._parent=I,I._children.pop(),I._children.push(T),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0),delete t.pendingLinkNode}if(t.pendingHtmlNode&&!o._fTextNode&&o._tag==="w:p"){const T=t.pendingHtmlNode,I=o._parent;I&&(T._parent=I,I._children.pop(),I._children.push(T),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0),delete t.pendingHtmlNode}!o._fTextNode&&o._tag==="w:tc"&&!o._children.filter(T=>!T._fTextNode&&(T._tag==="w:p"||T._tag==="w:altChunk")).length&&o._children.push({_parent:o,_children:[],_fTextNode:!1,_tag:"w:p",_attrs:{}}),!o._fTextNode&&o._tag==="w:rPr"&&(t.textRunPropsNode=o),!u._fTextNode&&u._tag==="w:r"&&delete t.textRunPropsNode}if(m==="DOWN"||m==="SIDE"){if(m==="SIDE"){if(o._parent==null)throw new InternalError("node parent is null");o=o._parent}const w=u._fTextNode?null:u._tag;(w==="w:p"||w==="w:tr")&&(t.buffers[w]={text:"",cmds:"",fInsertedText:!1});const T=cloneNodeWithoutChildren(u);T._parent=o,o._children.push(T);const I=T._tag;!isLoopExploring(t)&&(I==="wp:docPr"||I==="v:shape")&&(logger.debug("detected a - ",debugPrintNode(T)),updateID(T,t));const N=u._parent;if(u._fTextNode&&N&&!N._fTextNode&&N._tag==="w:t"){const k=await processText(e,u,t,n);typeof k=="string"?(T._text=k,logger.debug("Inserted command result string into node. Updated node: "+debugPrintNode(T))):p.push(...k)}o=T}if(m==="JUMP")for(;_>0;){if(o._parent==null)throw new InternalError("node parent is null");o=o._parent,_-=1}}if(t.gCntIf!==t.gCntEndIf){if((s=t.options)==null?void 0:s.failFast)throw new IncompleteConditionalStatementError;p.push(new IncompleteConditionalStatementError)}return p.length>0?{status:"errors",errors:p}:{status:"success",report:l,images:t.images,links:t.links,htmls:t.htmls}}const processText=async(e,r,t,n)=>{const{cmdDelimiter:s,failFast:l}=t.options,u=r._text;if(u==null||u==="")return"";const o=u.split(s[0]).map(p=>p.split(s[1])).reduce((p,A)=>p.concat(A));let m="";const _=[];for(let p=0;p<o.length;p++){p>0&&appendTextToTagBuffers(s[0],t,{fCmd:!0});const A=o[p];if(t.fCmd?t.cmd+=A:isLoopExploring(t)||(m+=A),appendTextToTagBuffers(A,t,{fCmd:t.fCmd}),p<o.length-1){if(t.fCmd){const v=await n(e,r,t);if(v!=null)if(typeof v=="string")m+=v,appendTextToTagBuffers(v,t,{fCmd:!1,fInsertedText:!0});else{if(l)throw v;_.push(v)}}t.fCmd=!t.fCmd}}return _.length>0?_:m},processCmd=async(e,r,t)=>{const n=getCommand(t.cmd,t.shorthands,t.options.fixSmartQuotes);t.cmd="";try{const{cmdName:s,cmdRest:l}=splitCommand(n);if(s!=="CMD_NODE"&&logger.debug(`Processing cmd: ${n}`),t.fSeekQuery){s==="QUERY"&&(t.query=l);return}if(!(s==="QUERY"||s==="CMD_NODE"))if(s==="ALIAS"){const u=/^(\S+)\s+(.+)/.exec(l);if(!u)throw new InvalidCommandError("Invalid ALIAS command",n);const o=u[1],m=u[2];t.shorthands[o]=m,logger.debug(`Defined alias '${o}' for: ${m}`)}else if(s==="FOR"||s==="IF")await processForIf(e,r,t,n,s,l);else if(s==="END-FOR"||s==="END-IF")processEndForIf(r,t,n,s,l);else if(s==="INS"){if(!isLoopExploring(t)){let u=await runUserJsAndGetRaw(e,l,t);if(u==null)return"";if(typeof u=="object"&&!Array.isArray(u)){const m=new ObjectCommandResultError(l);if(t.options.errorHandler!=null)u=await t.options.errorHandler(m,l);else throw m}let o=String(u);if(t.options.processLineBreaks){const{literalXmlDelimiter:m}=t.options;if(t.options.processLineBreaksAsNewText){const _=o.split(`
`),p=`${m}<w:br/>${m}`,A=`${m}</w:t>${m}`,v=`${m}<w:t xml:space="preserve">${m}`;o=_.join(`${A}${p}${v}`)}else o=o.replace(/\n/g,`${m}<w:br/>${m}`)}return o}}else if(s==="EXEC")isLoopExploring(t)||await runUserJsAndGetRaw(e,l,t);else if(s==="IMAGE"){if(!isLoopExploring(t)){const u=await runUserJsAndGetRaw(e,l,t);if(u!=null)try{processImage(t,u)}catch(o){throw o instanceof Error?new ImageError(o,n):o}}}else if(s==="LINK"){if(!isLoopExploring(t)){const u=await runUserJsAndGetRaw(e,l,t);u!=null&&await processLink(t,u)}}else if(s==="HTML"){if(!isLoopExploring(t)){const u=await runUserJsAndGetRaw(e,l,t);u!=null&&await processHtml(t,u)}}else throw new CommandSyntaxError(n);return}catch(s){if(!(s instanceof Error))throw s;return t.options.errorHandler!=null?t.options.errorHandler(s):s}},builtInRegexes=BUILT_IN_COMMANDS.map(e=>new RegExp(`^${e}\\b`)),notBuiltIns=e=>!builtInRegexes.some(r=>r.test(e.toUpperCase()));function getCommand(e,r,t){let n=e.trim();if(n[0]==="*"){const s=n.slice(1).trim();if(!r[s])throw new InvalidCommandError("Unknown alias",n);n=r[s]}else n[0]==="="?n=`INS ${n.slice(1).trim()}`:n[0]==="!"?n=`EXEC ${n.slice(1).trim()}`:notBuiltIns(n)&&(n=`INS ${n.trim()}`);return t&&(n=n.replace(/[\u201C\u201D\u201E]/g,'"').replace(/[\u2018\u2019\u201A]/g,"'")),n.trim()}function splitCommand(e){const r=/^(\S+)\s*/.exec(e);let t,n="";return r!=null&&(t=r[1].toUpperCase(),n=e.slice(t.length).trim()),{cmdName:t,cmdRest:n}}const processForIf=async(e,r,t,n,s,l)=>{const u=s==="IF";let o=null,m;if(u)r._ifName||(r._ifName=`__if_${t.gCntIf}`,t.gCntIf+=1),m=r._ifName;else{if(o=/^(\S+)\s+IN\s+(.+)/i.exec(l),!o)throw new InvalidCommandError("Invalid FOR command",n);m=o[1]}const _=getCurLoop(t);if(!(_&&_.varName===m)){const p=t.loops.length-1,A=p>=0&&t.loops[p].idx===-1;let v;if(A)v=[];else if(u)v=!!await runUserJsAndGetRaw(e,l,t)?[1]:[];else{if(!o)throw new InvalidCommandError("Invalid FOR command",n);if(v=await runUserJsAndGetRaw(e,o[2],t),!Array.isArray(v))throw new InvalidCommandError("Invalid FOR command (can only iterate over Array)",n)}t.loops.push({refNode:r,refNodeLevel:t.level,varName:m,loopOver:v,isIf:u,idx:-1})}logLoop(t.loops)},processEndForIf=(e,r,t,n,s)=>{const l=getCurLoop(r);if(!l)throw new InvalidCommandError("Unexpected END-IF outside of IF statement context",t);const u=n==="END-IF";u&&!e._ifName&&(e._ifName=l.varName,r.gCntEndIf+=1);const o=u?e._ifName:s;if(l.varName!==o){if(r.loops.find(p=>p.varName===o)==null){logger.debug(`Ignoring ${t} (${o}, but we're expecting ${l.varName})`);return}throw new InvalidCommandError("Invalid command",t)}const m=l.idx+1,_=l.loopOver[m];_!=null?(r.vars[o]=_,r.fJump=!0,l.idx=m):r.loops.pop()},imageToContext=(e,r)=>{validateImage(r),e.imageAndShapeIdIncrement+=1;const n=`img${String(e.imageAndShapeIdIncrement)}`;return e.images[n]=r,n};function validateImage(e){if(!(e.data instanceof Buffer||e.data instanceof ArrayBuffer||typeof e.data=="string"))throw new Error("image .data property needs to be provided as Buffer, ArrayBuffer, or as a base64-encoded string");if(!ImageExtensions.includes(e.extension))throw new Error(`An extension (one of ${ImageExtensions}) needs to be provided when providing an image or a thumbnail.`)}function validateImagePars(e){if(!Number.isFinite(e.width))throw new Error(`invalid image width: ${e.width} (in cm)`);if(!Number.isFinite(e.height))throw new Error(`invalid image height: ${e.height} (in cm)`);validateImage(e),e.thumbnail&&validateImage(e.thumbnail)}const processImage=(e,r)=>{var t;validateImagePars(r);const n=(r.width*36e4).toFixed(0),s=(r.height*36e4).toFixed(0);let l=imageToContext(e,getImageData(r));const u=String(e.imageAndShapeIdIncrement),o=r.alt||"desc",m=newNonTextNode,_=[];_.push(m("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[m("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})]));const p=r.rotation?(r.rotation*6e4).toString():void 0;if(e.images[l].extension===".svg"){const w=(t=r.thumbnail)!=null?t:{data:"bm90aGluZwo=",extension:".png"},T=imageToContext(e,w);_.push(m("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[m("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":l})])),l=T}const A=m("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[m("pic:nvPicPr",{},[m("pic:cNvPr",{id:"0",name:`Picture ${u}`,descr:o}),m("pic:cNvPicPr",{},[m("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),m("pic:blipFill",{},[m("a:blip",{"r:embed":l,cstate:"print"},[m("a:extLst",{},_)]),m("a:srcRect"),m("a:stretch",{},[m("a:fillRect")])]),m("pic:spPr",{bwMode:"auto"},[m("a:xfrm",p?{rot:p}:{},[m("a:off",{x:"0",y:"0"}),m("a:ext",{cx:n,cy:s})]),m("a:prstGeom",{prst:"rect"},[m("a:avLst")]),m("a:noFill"),m("a:ln",{},[m("a:noFill")])])]),v=m("w:drawing",{},[m("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[m("wp:extent",{cx:n,cy:s}),m("wp:docPr",{id:u,name:`Picture ${u}`,descr:o}),m("wp:cNvGraphicFramePr",{},[m("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),m("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[m("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[A])])])]);e.pendingImageNode={image:v},r.caption&&(e.pendingImageNode.caption=[m("w:br"),m("w:t",{},[newTextNode(r.caption)])])};function getImageData(e){const{data:r,extension:t}=e;if(!t)throw new Error("If you return image `data`, make sure you return an extension as well!");return{extension:t,data:r}}const processLink=async(e,r)=>{const{url:t,label:n=t}=r;e.linkId+=1;const l=`link${String(e.linkId)}`;e.links[l]={url:t};const u=newNonTextNode,{textRunPropsNode:o}=e,m=u("w:hyperlink",{"r:id":l,"w:history":"1"},[u("w:r",{},[o||u("w:rPr",{},[u("w:u",{"w:val":"single"})]),u("w:t",{},[newTextNode(n)])])]);e.pendingLinkNode=m},processHtml=async(e,r)=>{e.htmlId+=1;const n=`html${String(e.htmlId)}`;e.htmls[n]=r;const l=newNonTextNode("w:altChunk",{"r:id":n});e.pendingHtmlNode=l},BufferKeys=["w:p","w:tr"],appendTextToTagBuffers=(e,r,t)=>{if(r.fSeekQuery)return;const{fCmd:n,fInsertedText:s}=t,l=n?"cmds":"text";BufferKeys.forEach(u=>{const o=r.buffers[u];o[l]+=e,s&&(o.fInsertedText=!0)})};function updateID(e,r){r.imageAndShapeIdIncrement+=1;const t=String(r.imageAndShapeIdIncrement);e._attrs=__spreadProps(__spreadValues({},e._attrs),{id:`${t}`})}const DEFAULT_CMD_DELIMITER="+++",DEFAULT_LITERAL_XML_DELIMITER="||",CONTENT_TYPES_PATH="[Content_Types].xml",TEMPLATE_PATH="word",XML_FILE_REGEX=new RegExp(`${TEMPLATE_PATH}\\/[^\\/]+\\.xml`);async function parseTemplate(e){const r=await zipLoad(e),t=await readContentTypes(r),n=getMainDoc(t),s=`${TEMPLATE_PATH}/${n}`,l=await zipGetText(r,s);if(l==null)throw new TemplateParseError(`${n} could not be found`);logger.debug(`${s} file length: ${l.length}`),new Date().getTime();const o=await parseXml(l);return new Date().getTime(),{jsTemplate:o,mainDocument:n,zip:r,contentTypes:t}}async function prepSecondaryXMLs(e,r,t){const n=[];e.forEach(async l=>{XML_FILE_REGEX.test(l)&&l!==`${TEMPLATE_PATH}/${r}`&&l.indexOf(`${TEMPLATE_PATH}/template`)!==0&&n.push(l)}),n.sort();const s=[];for(const l of n){const u=await zipGetText(e,l);if(u==null)throw new TemplateParseError(`${l} could not be read`);logger.debug(`${l} file length: ${u.length}`);const o=await parseXml(u),m=preprocessTemplate(o,t.cmdDelimiter);s.push([m,l])}return s}async function createReport(e,r){const{template:t,data:n,queryVars:s}=e,l=e.literalXmlDelimiter||DEFAULT_LITERAL_XML_DELIMITER,u={cmdDelimiter:getCmdDelimiter(e.cmdDelimiter),literalXmlDelimiter:l,processLineBreaks:e.processLineBreaks!=null?e.processLineBreaks:!0,noSandbox:e.noSandbox||!1,runJs:e.runJs,additionalJsContext:e.additionalJsContext||{},failFast:e.failFast==null?!0:e.failFast,rejectNullish:e.rejectNullish==null?!1:e.rejectNullish,errorHandler:typeof e.errorHandler=="function"?e.errorHandler:null,fixSmartQuotes:e.fixSmartQuotes==null?!1:e.fixSmartQuotes,processLineBreaksAsNewText:e.processLineBreaksAsNewText==null?!1:e.processLineBreaksAsNewText},o={literalXmlDelimiter:l},{jsTemplate:m,mainDocument:_,zip:p,contentTypes:A}=await parseTemplate(t),v=preprocessTemplate(m,u.cmdDelimiter);let w=null;if(typeof n=="function"){const U=await extractQuery(v,u);w=await n(U,s)}else w=n;const T=await prepSecondaryXMLs(p,_,u),I=Math.max(...T.map(([U,F])=>findHighestImgId(U)),findHighestImgId(v));let N=newContext(u,I);const k=await produceJsReport(w,v,N);if(k.status==="errors")throw k.errors;const{report:D,images:B,links:R,htmls:O}=k;if(r==="JS")return D;const P=buildXml(D,o);if(r==="XML")return P;zipSetText(p,`${TEMPLATE_PATH}/${_}`,P);let L=Object.keys(B).length,M=Object.keys(O).length;await processImages(B,_,p),await processLinks(R,_,p),await processHtmls(O,_,p);for(const[U,F]of T){N=newContext(u,N.imageAndShapeIdIncrement);const Z=await produceJsReport(w,U,N);if(Z.status==="errors")throw Z.errors;const{report:te,images:ie,links:ne,htmls:fe}=Z,H=buildXml(te,o);zipSetText(p,F,H),L+=Object.keys(ie).length,M+=Object.keys(fe).length;const se=F.split("/"),he=se[se.length-1];await processImages(ie,he,p),await processLinks(ne,_,p),await processHtmls(fe,_,p)}if(L||M){const U=(Z,te)=>{A._children.filter(ne=>!ne._fTextNode&&ne._attrs.Extension===Z).length||addChild(A,newNonTextNode("Default",{Extension:Z,ContentType:te}))};L&&(U("png","image/png"),U("jpg","image/jpeg"),U("jpeg","image/jpeg"),U("gif","image/gif"),U("bmp","image/bmp"),U("svg","image/svg+xml")),M&&U("html","text/html");const F=buildXml(A,o);zipSetText(p,CONTENT_TYPES_PATH,F)}return await zipSave(p)}async function listCommands(e,r){const t={cmdDelimiter:getCmdDelimiter(r),literalXmlDelimiter:DEFAULT_LITERAL_XML_DELIMITER,processLineBreaks:!0,noSandbox:!1,additionalJsContext:{},failFast:!1,rejectNullish:!1,errorHandler:null,fixSmartQuotes:!1,processLineBreaksAsNewText:!1},{jsTemplate:n,mainDocument:s,zip:l}=await parseTemplate(e),u=await prepSecondaryXMLs(l,s,t),o=[n,...u.map(([_,p])=>_)],m=[];for(const _ of o){const p=preprocessTemplate(_,t.cmdDelimiter),A=newContext(t);await walkTemplate(void 0,p,A,async(v,w,T)=>{const I=getCommand(T.cmd,T.shorthands,T.options.fixSmartQuotes);T.cmd="";const{cmdName:N,cmdRest:k}=splitCommand(I),D=N;D!=null&&D!=="CMD_NODE"&&m.push({raw:I,type:D,code:k})})}return m}async function getMetadata(e){const r="docProps/app.xml",t="docProps/core.xml",n=await zipLoad(e),s=await parsePath(n,r),l=await parsePath(n,t);function u(_){if(_._children.length===0)return;const p=_._children[0];if(p._fTextNode)return p._text;throw new Error("Not a text node")}function o(_,p){for(const A of _._children)if(!A._fTextNode&&A._tag===p)return u(A)}const m=_=>{const p=Number(_);if(Number.isFinite(p))return p};return{pages:m(o(s,"Pages")),words:m(o(s,"Words")),characters:m(o(s,"Characters")),lines:m(o(s,"Lines")),paragraphs:m(o(s,"Paragraphs")),company:o(s,"Company"),template:o(s,"Template"),title:o(l,"dc:title"),subject:o(l,"dc:subject"),creator:o(l,"dc:creator"),description:o(l,"dc:description"),lastModifiedBy:o(l,"cp:lastModifiedBy"),revision:o(l,"cp:revision"),lastPrinted:o(l,"cp:lastPrinted"),created:o(l,"dcterms:created"),modified:o(l,"dcterms:modified"),category:o(l,"cp:category")}}async function parsePath(e,r){const t=await zipGetText(e,r);if(t==null)throw new TemplateParseError(`${r} could not be read`);const n=await parseXml(t);if(n._fTextNode)throw new TemplateParseError(`${r} is a text node when parsed`);return n}async function readContentTypes(e){return await parsePath(e,CONTENT_TYPES_PATH)}function getMainDoc(e){const r=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml"];for(const t of e._children)if(!t._fTextNode&&t._attrs.ContentType!=null&&r.includes(t._attrs.ContentType)){const n=t._attrs.PartName;if(n)return n.replace("/word/","")}throw new TemplateParseError(`Could not find main document (e.g. document.xml) in ${CONTENT_TYPES_PATH}`)}const processImages=async(e,r,t)=>{const n=Object.keys(e);if(!n.length)return;const s=`${TEMPLATE_PATH}/_rels/${r}.rels`,l=await getRelsFromZip(t,s);for(const o of n){const{extension:m,data:_}=e[o],p=`template_${r}_${o}${m}`,A=`${TEMPLATE_PATH}/media/${p}`;typeof _=="string"?zipSetBase64(t,A,_):zipSetBinary(t,A,_),addChild(l,newNonTextNode("Relationship",{Id:o,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`media/${p}`}))}const u=buildXml(l,{literalXmlDelimiter:DEFAULT_LITERAL_XML_DELIMITER});zipSetText(t,s,u)},processLinks=async(e,r,t)=>{const n=Object.keys(e);if(n.length){const s=`${TEMPLATE_PATH}/_rels/${r}.rels`,l=await getRelsFromZip(t,s);for(const o of n){const{url:m}=e[o];addChild(l,newNonTextNode("Relationship",{Id:o,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Target:m,TargetMode:"External"}))}const u=buildXml(l,{literalXmlDelimiter:DEFAULT_LITERAL_XML_DELIMITER});zipSetText(t,s,u)}},processHtmls=async(e,r,t)=>{const n=Object.keys(e);if(n.length){const s=`${TEMPLATE_PATH}/_rels/${r}.rels`,l=await getRelsFromZip(t,s);for(const o of n){const m=e[o],_=`template_${r.replace(/\./g,"_")}_${o}.html`,p=`${TEMPLATE_PATH}/${_}`;zipSetText(t,p,m),addChild(l,newNonTextNode("Relationship",{Id:o,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk",Target:`${_}`}))}const u=buildXml(l,{literalXmlDelimiter:DEFAULT_LITERAL_XML_DELIMITER});zipSetText(t,s,u)}},getRelsFromZip=async(e,r)=>{let t=await zipGetText(e,r);return t||(t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
        </Relationships>`),parseXml(t)},getCmdDelimiter=e=>e?typeof e=="string"?[e,e]:e:[DEFAULT_CMD_DELIMITER,DEFAULT_CMD_DELIMITER];export{CommandExecutionError,CommandSyntaxError,ImageError,IncompleteConditionalStatementError,InternalError,InvalidCommandError,NullishCommandResultError,ObjectCommandResultError,TemplateParseError,createReport,getMetadata,listCommands};
//# sourceMappingURL=browser.js.map
